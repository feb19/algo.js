/*!*
 * algo.js
 *
 * JavaScript Creative Coding Framework
 * http://algojs.com
 *
 * Copyright 2015 hisa hayashi, HYS INC.
 */
var ALGO=function(){"use strict";function e(r){L=this,y=e.ObjectUtil.extend(param,r),n()}function n(){r(),t(),i()}function r(){L.width=param.width,L.height=param.height}function t(){L.render=new e.Render(L),L.render.setFramerate(L.framerate)}function o(){L.canvas=document.getElementById(y.id),L.canvas.width=y.width,L.canvas.height=y.height,L.renderer=new e.WebGLRenderer(L)}function i(){window.onload=function(){o(),L.setup&&L.setup.call(L)},window.onmouseover=function(){L.mouseover&&L.mouseover.call(L)},window.onmouseout=function(){L.mouseout&&L.mouseout.call(L)},window.onmousedown=function(){L.mousedown&&L.mousedown.call(L)},window.onmouseup=function(){L.mouseup&&L.mouseup.call(L)},window.onmousemove=function(){L.mousemove&&L.mousemove.call(L)},window.onkeydown=function(){L.keydown&&L.keydown.call(L)},window.onkeyup=function(){L.keyup&&L.keyup.call(L)},window.onresize=function(){L.resize&&L.resize.call(L)},L.render.startRender()}function a(e,n){this[e]=n,L[e]=this[e],L=this}function u(e,n){this[e]=n,L[e]=null}function c(){}function f(){}function d(){}function s(){}function l(){}function g(){}function m(){}function p(){}function A(){}function w(){}function h(){}function v(e,n){L.canvas.width=e,L.canvas.height=n}var L,y={id:"",width:window.innerWidth,height:window.innerHeight};return e.prototype={constructor:e,setup:c,frame:f,destroy:d,mouseover:s,mouseout:l,mousedown:g,mouseup:m,mousemove:p,keydown:A,keyup:w,resize:h,bind:a,unbind:u,size:v,render:null,renderer:null},e}();ALGO.Circle=function(){"use strict";return ALGO.Circle=function(){ALGO.log("ALGO.Circle")},ALGO.Circle.prototype={constructor:ALGO.Circle},ALGO.Circle}(),ALGO.ColorUtil={rgbToHex:function(e,n,r){e=Math.floor(e),n=Math.floor(n),r=Math.floor(r);var t=(e<<16)+(n<<8)+r;return"0x"+t.toString(16)},hexToRgb:function(e){e=e.toString(16).replace("#","").replace("0x",""),e="0x"+e;var n={r:e>>16,g:e>>8&255,b:255&e};return n},hexToRgbNormalize:function(e){var n=ALGO.ColorUtil.hexToRgb(e);return n.r=n.r/256,n.g=n.g/256,n.b=n.b/256,n}},ALGO.log=function(e){window.console&&window.console.log&&ALGO.debug&&window.console.log(e)},ALGO.warn=function(e){window.console&&window.console.warn&&ALGO.debug&&window.console.warn(e)},ALGO.error=function(e){window.console&&window.console.error&&ALGO.debug&&window.console.error(e)},ALGO.Matrix=function(e){"use strict";function n(){return new Float32Array(16)}function r(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function t(e,n,r){var t=e[0],o=e[1],i=e[2],a=e[3],u=e[4],c=e[5],f=e[6],d=e[7],s=e[8],l=e[9],g=e[10],m=e[11],p=e[12],A=e[13],w=e[14],h=e[15],v=n[0],L=n[1],y=n[2],x=n[3],O=n[4],G=n[5],R=n[6],b=n[7],_=n[8],E=n[9],M=n[10],S=n[11],F=n[12],T=n[13],k=n[14],B=n[15];return r[0]=v*t+L*u+y*s+x*p,r[1]=v*o+L*c+y*l+x*A,r[2]=v*i+L*f+y*g+x*w,r[3]=v*a+L*d+y*m+x*h,r[4]=O*t+G*u+R*s+b*p,r[5]=O*o+G*c+R*l+b*A,r[6]=O*i+G*f+R*g+b*w,r[7]=O*a+G*d+R*m+b*h,r[8]=_*t+E*u+M*s+S*p,r[9]=_*o+E*c+M*l+S*A,r[10]=_*i+E*f+M*g+S*w,r[11]=_*a+E*d+M*m+S*h,r[12]=F*t+T*u+k*s+B*p,r[13]=F*o+T*c+k*l+B*A,r[14]=F*i+T*f+k*g+B*w,r[15]=F*a+T*d+k*m+B*h,r}function o(e,n,r){return r[0]=e[0]*n[0],r[1]=e[1]*n[0],r[2]=e[2]*n[0],r[3]=e[3]*n[0],r[4]=e[4]*n[1],r[5]=e[5]*n[1],r[6]=e[6]*n[1],r[7]=e[7]*n[1],r[8]=e[8]*n[2],r[9]=e[9]*n[2],r[10]=e[10]*n[2],r[11]=e[11]*n[2],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function i(e,n,r){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[0]*n[0]+e[4]*n[1]+e[8]*n[2]+e[12],r[13]=e[1]*n[0]+e[5]*n[1]+e[9]*n[2]+e[13],r[14]=e[2]*n[0]+e[6]*n[1]+e[10]*n[2]+e[14],r[15]=e[3]*n[0]+e[7]*n[1]+e[11]*n[2]+e[15],r}function a(e,n,r,t){var o=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);if(!o)return null;var i=r[0],a=r[1],u=r[2];1!=o&&(o=1/o,i*=o,a*=o,u*=o);var c=Math.sin(n),f=Math.cos(n),d=1-f,s=e[0],l=e[1],g=e[2],m=e[3],p=e[4],A=e[5],w=e[6],h=e[7],v=e[8],L=e[9],y=e[10],x=e[11],O=i*i*d+f,G=a*i*d+u*c,R=u*i*d-a*c,b=i*a*d-u*c,_=a*a*d+f,E=u*a*d+i*c,M=i*u*d+a*c,S=a*u*d-i*c,F=u*u*d+f;return n?e!=t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]):t=e,t[0]=s*O+p*G+v*R,t[1]=l*O+A*G+L*R,t[2]=g*O+w*G+y*R,t[3]=m*O+h*G+x*R,t[4]=s*b+p*_+v*E,t[5]=l*b+A*_+L*E,t[6]=g*b+w*_+y*E,t[7]=m*b+h*_+x*E,t[8]=s*M+p*S+v*F,t[9]=l*M+A*S+L*F,t[10]=g*M+w*S+y*F,t[11]=m*M+h*S+x*F,t}function u(e,n,t,o){var i=e[0],a=e[1],u=e[2],c=t[0],f=t[1],d=t[2],s=n[0],l=n[1],g=n[2];if(i==s&&a==l&&u==g)return r(o);var m,p,A,w,h,v,L,y,x,O;return L=i-n[0],y=a-n[1],x=u-n[2],O=1/Math.sqrt(L*L+y*y+x*x),L*=O,y*=O,x*=O,m=f*x-d*y,p=d*L-c*x,A=c*y-f*L,O=Math.sqrt(m*m+p*p+A*A),O?(O=1/O,m*=O,p*=O,A*=O):(m=0,p=0,A=0),w=y*A-x*p,h=x*m-L*A,v=L*p-y*m,O=Math.sqrt(w*w+h*h+v*v),O?(O=1/O,w*=O,h*=O,v*=O):(w=0,h=0,v=0),o[0]=m,o[1]=w,o[2]=L,o[3]=0,o[4]=p,o[5]=h,o[6]=y,o[7]=0,o[8]=A,o[9]=v,o[10]=x,o[11]=0,o[12]=-(m*i+p*a+A*u),o[13]=-(w*i+h*a+v*u),o[14]=-(L*i+y*a+x*u),o[15]=1,o}function c(e,n,r,t,o){var i=r*Math.tan(e*Math.PI/360),a=i*n,u=2*a,c=2*i,f=t-r;return o[0]=2*r/u,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*r/c,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-(t+r)/f,o[11]=-1,o[12]=0,o[13]=0,o[14]=-(t*r*2)/f,o[15]=0,o}function f(e,n){return n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15],n}function d(e,n){var r=e[0],t=e[1],o=e[2],i=e[3],a=e[4],u=e[5],c=e[6],f=e[7],d=e[8],s=e[9],l=e[10],g=e[11],m=e[12],p=e[13],A=e[14],w=e[15],h=r*u-t*a,v=r*c-o*a,L=r*f-i*a,y=t*c-o*u,x=t*f-i*u,O=o*f-i*c,G=d*p-s*m,R=d*A-l*m,b=d*w-g*m,_=s*A-l*p,E=s*w-g*p,M=l*w-g*A,S=1/(h*M-v*E+L*_+y*b-x*R+O*G);return n[0]=(u*M-c*E+f*_)*S,n[1]=(-t*M+o*E-i*_)*S,n[2]=(p*O-A*x+w*y)*S,n[3]=(-s*O+l*x-g*y)*S,n[4]=(-a*M+c*b-f*R)*S,n[5]=(r*M-o*b+i*R)*S,n[6]=(-m*O+A*L-w*v)*S,n[7]=(d*O-l*L+g*v)*S,n[8]=(a*E-u*b+f*G)*S,n[9]=(-r*E+t*b-i*G)*S,n[10]=(m*x-p*L+w*h)*S,n[11]=(-d*x+s*L-g*h)*S,n[12]=(-a*_+u*R-c*G)*S,n[13]=(r*_-t*R+o*G)*S,n[14]=(-m*y+p*v-A*h)*S,n[15]=(d*y-s*v+l*h)*S,n}return e.Matrix=function(){},e.Matrix.prototype={constructor:e.Matrix,create:n,identity:r,multiply:t,scale:o,translate:i,rotate:a,lookAt:u,perspective:c,transpose:f,inverse:d},e.Matrix}(ALGO),ALGO.ObjectUtil={extend:function(e,n){ALGO.ObjectUtil.clone(e);for(key in n){var r=n[key]?n[key]:e[key];e[key]=r}return e},clone:function(e){var n={};for(key in e)n[key]=e[key];return n}},ALGO.PointUtil={normalize:function(e,n){var r=Math.sqrt(e.x*e.x+e.y*e.y);0!=r&&(e.x=n*e.x/r,e.y=n*e.y/r)},normalize3:function(e,n){var r=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z);return 0!=r&&(e.x=n*e.x/r,e.y=n*e.y/r,e.z=n*e.z/r),e},pointLength3:function(e){return Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)},getDistance:function(e,n){var r=n.x-e.x,t=n.y-e.y;return Math.sqrt(r*r+t*t)},getSlope:function(e,n){return(n.y-e.y)/(n.x-e.x)},getIntercept:function(e,n,r){var t=e.x+n.x,o=e.y+n.y;return o/2-r*t/2},getMidpoint:function(e,n){var r=[];return r.x=(e.x+n.x)/2,r.y=(e.y+n.y)/2,r},getMidperpendicular:function(e,n){var r=getSlope(e,n);x=checkEQ(r)?1:-1/r;var t=getMidpoint(e,n);return y=checkEQ(r)?0:t.y-x*t.x,{x:x,y:y}},getThroughPoint3:function(e,n,r){var t=getMidperpendicular(e,n),o=getMidperpendicular(e,r),i=[];i.x=(o.y-t.y)/(t.x-o.x),i.y=t.x*i.x+t.y;var a=Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2));return{x:i.x,y:i.y,rad:a}},getHugeTriangle:function(e,n,r){var t=getThroughPoint3(e,n,r),o=t.x-Math.sqrt(3)*t.rad,i=t.y-t.rad,a=t.x+Math.sqrt(3)*t.rad,u=t.y-t.rad,c=t.x,f=t.y+2*t.rad;return[{x:o,y:i},{x:a,y:u},{x:c,y:f}]},checkEQ:function(e){var n=1e-6;return e>=-n&&n>=e}},ALGO.Render=function(){"use strict";function e(){n(),r()}function n(){}function r(){}function t(e){f=e,d=1e3/f,ALGO.log("setFramerate = "+f)}function o(){return f}function i(){p=!0,d=1e3/f,g=Date.now(),s=g,u()}function a(){p=!1}function u(){if(p&&w(u),l=Date.now(),m=l-g,m>d){g=l-m%d,c.renderer&&c.renderer.update(),c.frame&&c.frame.call(c);{var e=l-s;Math.round(1e3/(e/++A)*100)/100}}}var c,f,d,s,l,g,m,p=!1,A=0,w=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/f)};return ALGO.Render=function(n){c=n,e()},ALGO.Render.prototype={constructor:ALGO.Render,setFramerate:t,getFramerate:o,startRender:i,stopRender:a},ALGO.Render}(),ALGO.Shape=function(){"use strict";return ALGO.Shape=function(){ALGO.log("ALGO.Shape")},ALGO.Shape.prototype={constructor:ALGO.Shape},ALGO.Shape}(),ALGO.StringUtil={zeroPadding:function(e,n){return(Array(n).join("0")+e).slice(-n)},numComma:function(e){return String(e).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},separate:function(e){return String(e).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")}},ALGO.Util={getBrowserLang:function(){var e=window.navigator.userAgent.toLowerCase();try{return-1!=e.indexOf("chrome")?(navigator.languages[0]||navigator.browserLanguage||navigator.language||navigator.userLanguage).substr(0,2):(navigator.browserLanguage||navigator.language||navigator.userLanguage).substr(0,2)}catch(n){return void 0}},isSmartDevice:function(){var e=navigator.userAgent,n=!1;return e.indexOf("iPhone")>0&&-1==e.indexOf("iPad")||e.indexOf("iPod")>0||e.indexOf("Android")>0&&e.indexOf("Mobile")>0?n="smartphone":(e.indexOf("iPad")>0||e.indexOf("Android")>0)&&(n="tablet"),n},getOS:function(){var e,n=window.navigator.userAgent.toLowerCase();return e=n.match(/win/)?"win":n.match(/mac|ppc/)?"mac":n.match(/linux/)?"linux":"other"},getBrowser:function(){var e=window.navigator.userAgent.toLowerCase(),n=window.navigator.appVersion.toLowerCase(),r="unknown";return-1!=e.indexOf("msie")?r=-1!=n.indexOf("msie 6.")?"ie6":-1!=n.indexOf("msie 7.")?"ie7":-1!=n.indexOf("msie 8.")?"ie8":-1!=n.indexOf("msie 9.")?"ie9":-1!=n.indexOf("msie 10.")?"ie10":"ie":-1!=e.indexOf("trident/7")?r="ie11":-1!=e.indexOf("chrome")?r="chrome":-1!=e.indexOf("safari")?r="safari":-1!=e.indexOf("opera")?r="opera":-1!=e.indexOf("firefox")&&(r="firefox"),r},isSupported:function(e){for(var n=getBrowser(),r=0;r<e.length;r++)if(e[r]==n)return!0;return!1},getQuery:function(){for(var e=window.location.search.substring(1),n=e.split("&"),r={},t=0;t<n.length;t++){var o=n[t].indexOf("=");if(o>0){var i=n[t].substring(0,o),a=n[t].substring(o+1);r[i]=a}}return r}},ALGO.debug=1,ALGO.BLEND_NONE=0,ALGO.BLEND_ADD=1,ALGO.BLEND_MULTIPLY=2,ALGO.BLEND_SCREEN=3,ALGO.prototype.__defineGetter__("framerate",function(){return this.framerate_}),ALGO.prototype.__defineSetter__("framerate",function(e){this.render&&this.render.setFramerate(e),this.framerate_=e}),ALGO.prototype.width=0,ALGO.prototype.height=0,ALGO.prototype.blendMode=ALGO.BLEND_NONE,ALGO.prototype.backgroundAuto=!0,ALGO.prototype.background=6710886,ALGO.prototype.backgroundAlpha=.5,ALGO.prototype.depth=1,ALGO.prototype.framerate=60,ALGO.prototype.canvas=null,ALGO.WebGLRenderer=function(e){"use strict";function n(){w=G.getContext("webgl")||G.getContext("experimental-webgl"),t(),o(),i()}function r(e){G=e.canvas,R=e.background,b=e.backgroundAlpha,_=e.backgroundAuto,E=e.depth}function t(){w.clearDepth(E)}function o(){var n=e.ColorUtil.hexToRgbNormalize(R);w.clearColor(n.r,n.g,n.b,b)}function i(){w.clear(w.COLOR_BUFFER_BIT|w.DEPTH_BUFFER_BIT)}function a(){d()}function u(){r(A),t(),o(),_&&i(),a()}function c(){h=s("vertex"),v=s("fragment"),L=g(h,v),y=[],y[0]=w.getAttribLocation(L,"position"),y[1]=w.getAttribLocation(L,"color")}function f(){x=[],x[0]=3,x[1]=4;var e=[0,1,0,1,0,0,-1,0,0,0,-1,0],n=[1,0,0,1,0,1,0,1,0,0,1,1,1,1,1,1],r=[];r[0]=m(e),r[1]=m(n),l(r,y,x),O=[0,1,2,1,2,3];var t=p(O);w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,t)}function d(){var n=new e.Matrix,r=n.identity(n.create()),t=n.identity(n.create()),o=n.identity(n.create()),i=n.identity(n.create()),a=n.identity(n.create());S+=1;var u=S%360*Math.PI/180;n.lookAt([0,0,5],[0,0,0],[0,1,0],t),n.perspective(90,G.width/G.height,.1,100,o),n.multiply(o,t,i);var c=[];c[0]=w.getUniformLocation(L,"mvp_matrix"),c[1]=w.getUniformLocation(L,"point_size"),n.identity(r),n.translate(r,[1.5,0,0],r),n.rotate(r,u,[0,1,0],r),n.multiply(i,r,a),w.uniformMatrix4fv(c[0],!1,a),w.drawElements(w.TRIANGLES,O.length,w.UNSIGNED_SHORT,0),n.identity(r),n.translate(r,[-1.5,0,0],r),n.rotate(r,-u,[0,1,0],r),n.multiply(i,r,a),w.uniformMatrix4fv(c[0],!1,a),w.uniform1f(c[1],M),w.drawElements(w.LINES,O.length,w.UNSIGNED_SHORT,0),w.flush()}function s(e){var n,r="";return"vertex"==e?(r="\r\n      attribute vec3 position;\r\n      attribute vec4 color;\r\n      uniform   mat4 mvp_matrix;\r\n      varying   vec4 v_color; \r\n      uniform float point_size;\r\n      \r\n      void main(void){\r\n        v_color = color;\r\n        gl_Position = mvp_matrix * vec4(position, 1.0);\r\n        gl_PointSize = point_size;\r\n      }",n=w.createShader(w.VERTEX_SHADER)):"fragment"==e&&(r="\r\n      precision mediump float;\r\n      varying vec4 v_color;\r\n      \r\n      void main(void){\r\n        gl_FragColor = v_color;\r\n      }",n=w.createShader(w.FRAGMENT_SHADER)),w.shaderSource(n,r),w.compileShader(n),w.getShaderParameter(n,w.COMPILE_STATUS)?n:void alert(w.getShaderInfoLog(n))}function l(e,n,r){for(var t in e)w.bindBuffer(w.ARRAY_BUFFER,e[t]),w.enableVertexAttribArray(n[t]),w.vertexAttribPointer(n[t],r[t],w.FLOAT,!1,0,0)}function g(e,n){var r=w.createProgram();return w.attachShader(r,e),w.attachShader(r,n),w.linkProgram(r),w.getProgramParameter(r,w.LINK_STATUS)?(w.useProgram(r),r):void alert(w.getProgramInfoLog(r))}function m(e){var n=w.createBuffer();return w.bindBuffer(w.ARRAY_BUFFER,n),w.bufferData(w.ARRAY_BUFFER,new Float32Array(e),w.STATIC_DRAW),w.bindBuffer(w.ARRAY_BUFFER,null),n}function p(e){var n=w.createBuffer();return w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,n),w.bufferData(w.ELEMENT_ARRAY_BUFFER,new Int16Array(e),w.STATIC_DRAW),w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,null),n}var A,w,h,v,L,y,x,O,G,R,b,_,E,M=10,S=0;return e.WebGLRenderer=function(e){A=e,r(A),n(),c(),f(),d()},e.WebGLRenderer.prototype={constructor:e.WebGLRenderer,update:u},e.WebGLRenderer}(ALGO);