function BufferLoader(t,e,n){this.context=t,this.urlList=e,this.onload=n,this.bufferList=new Array,this.loadCount=0}function FlowZone(t,e,n,i){this.x=t,this.y=e,this.u=n,this.v=i}function FlowCalculator(t){this.step=t||8}!function(t){function e(t,e,n){this.x=t,this.y=e,this.z=n}function n(t){return t*t*t*(t*(6*t-15)+10)}function i(t,e,n){return(1-n)*t+n*e}var o=t.noise={};e.prototype.dot2=function(t,e){return this.x*t+this.y*e},e.prototype.dot3=function(t,e,n){return this.x*t+this.y*e+this.z*n};var r=[new e(1,1,0),new e(-1,1,0),new e(1,-1,0),new e(-1,-1,0),new e(1,0,1),new e(-1,0,1),new e(1,0,-1),new e(-1,0,-1),new e(0,1,1),new e(0,-1,1),new e(0,1,-1),new e(0,-1,-1)],s=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],a=new Array(512),u=new Array(512);o.seed=function(t){t>0&&1>t&&(t*=65536),t=Math.floor(t),256>t&&(t|=t<<8);for(var e=0;256>e;e++){var n;n=1&e?s[e]^255&t:s[e]^t>>8&255,a[e]=a[e+256]=n,u[e]=u[e+256]=r[n%12]}},o.seed(0);var h=.5*(Math.sqrt(3)-1),l=(3-Math.sqrt(3))/6,p=1/3,c=1/6;o.simplex2=function(t,e){var n,i,o,r,s,p=(t+e)*h,c=Math.floor(t+p),d=Math.floor(e+p),f=(c+d)*l,g=t-c+f,y=e-d+f;g>y?(r=1,s=0):(r=0,s=1);var x=g-r+l,_=y-s+l,v=g-1+2*l,m=y-1+2*l;c&=255,d&=255;var A=u[c+a[d]],L=u[c+r+a[d+s]],C=u[c+1+a[d+1]],w=.5-g*g-y*y;0>w?n=0:(w*=w,n=w*w*A.dot2(g,y));var O=.5-x*x-_*_;0>O?i=0:(O*=O,i=O*O*L.dot2(x,_));var b=.5-v*v-m*m;return 0>b?o=0:(b*=b,o=b*b*C.dot2(v,m)),70*(n+i+o)},o.simplex3=function(t,e,n){var i,o,r,s,h,l,d,f,g,y,x=(t+e+n)*p,_=Math.floor(t+x),v=Math.floor(e+x),m=Math.floor(n+x),A=(_+v+m)*c,L=t-_+A,C=e-v+A,w=n-m+A;L>=C?C>=w?(h=1,l=0,d=0,f=1,g=1,y=0):L>=w?(h=1,l=0,d=0,f=1,g=0,y=1):(h=0,l=0,d=1,f=1,g=0,y=1):w>C?(h=0,l=0,d=1,f=0,g=1,y=1):w>L?(h=0,l=1,d=0,f=0,g=1,y=1):(h=0,l=1,d=0,f=1,g=1,y=0);var O=L-h+c,b=C-l+c,G=w-d+c,E=L-f+2*c,T=C-g+2*c,S=w-y+2*c,R=L-1+3*c,P=C-1+3*c,D=w-1+3*c;_&=255,v&=255,m&=255;var N=u[_+a[v+a[m]]],I=u[_+h+a[v+l+a[m+d]]],M=u[_+f+a[v+g+a[m+y]]],q=u[_+1+a[v+1+a[m+1]]],U=.6-L*L-C*C-w*w;0>U?i=0:(U*=U,i=U*U*N.dot3(L,C,w));var W=.6-O*O-b*b-G*G;0>W?o=0:(W*=W,o=W*W*I.dot3(O,b,G));var B=.6-E*E-T*T-S*S;0>B?r=0:(B*=B,r=B*B*M.dot3(E,T,S));var F=.6-R*R-P*P-D*D;return 0>F?s=0:(F*=F,s=F*F*q.dot3(R,P,D)),32*(i+o+r+s)},o.perlin2=function(t,e){var o=Math.floor(t),r=Math.floor(e);t-=o,e-=r,o=255&o,r=255&r;var s=u[o+a[r]].dot2(t,e),h=u[o+a[r+1]].dot2(t,e-1),l=u[o+1+a[r]].dot2(t-1,e),p=u[o+1+a[r+1]].dot2(t-1,e-1),c=n(t);return i(i(s,l,c),i(h,p,c),n(e))},o.perlin3=function(t,e,o){var r=Math.floor(t),s=Math.floor(e),h=Math.floor(o);t-=r,e-=s,o-=h,r=255&r,s=255&s,h=255&h;var l=u[r+a[s+a[h]]].dot3(t,e,o),p=u[r+a[s+a[h+1]]].dot3(t,e,o-1),c=u[r+a[s+1+a[h]]].dot3(t,e-1,o),d=u[r+a[s+1+a[h+1]]].dot3(t,e-1,o-1),f=u[r+1+a[s+a[h]]].dot3(t-1,e,o),g=u[r+1+a[s+a[h+1]]].dot3(t-1,e,o-1),y=u[r+1+a[s+1+a[h]]].dot3(t-1,e-1,o),x=u[r+1+a[s+1+a[h+1]]].dot3(t-1,e-1,o-1),_=n(t),v=n(e),m=n(o);return i(i(i(l,f,_),i(p,g,_),m),i(i(c,y,_),i(d,x,_),m),v)}}(this),!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.poly2tri=t()}}(function(){return function t(e,n,i){function o(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){var n=e[s][1][t];return o(n?n:t)},h,h.exports,t,e,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){e.exports={version:"1.3.5"}},{}],2:[function(t,e,n){"use strict";var i=function(t,e){this.point=t,this.triangle=e||null,this.next=null,this.prev=null,this.value=t.x},o=function(t,e){this.head_=t,this.tail_=e,this.search_node_=t};o.prototype.head=function(){return this.head_},o.prototype.setHead=function(t){this.head_=t},o.prototype.tail=function(){return this.tail_},o.prototype.setTail=function(t){this.tail_=t},o.prototype.search=function(){return this.search_node_},o.prototype.setSearch=function(t){this.search_node_=t},o.prototype.findSearchNode=function(){return this.search_node_},o.prototype.locateNode=function(t){var e=this.search_node_;if(t<e.value){for(;e=e.prev;)if(t>=e.value)return this.search_node_=e,e}else for(;e=e.next;)if(t<e.value)return this.search_node_=e.prev,e.prev;return null},o.prototype.locatePoint=function(t){var e=t.x,n=this.findSearchNode(e),i=n.point.x;if(e===i){if(t!==n.point)if(t===n.prev.point)n=n.prev;else{if(t!==n.next.point)throw new Error("poly2tri Invalid AdvancingFront.locatePoint() call");n=n.next}}else if(i>e)for(;(n=n.prev)&&t!==n.point;);else for(;(n=n.next)&&t!==n.point;);return n&&(this.search_node_=n),n},e.exports=o,e.exports.Node=i},{}],3:[function(t,e,n){"use strict";function i(t,e){if(!t)throw new Error(e||"Assert Failed")}e.exports=i},{}],4:[function(t,e,n){"use strict";var i=t("./xy"),o=function(t,e){this.x=+t||0,this.y=+e||0,this._p2t_edge_list=null};o.prototype.toString=function(){return i.toStringBase(this)},o.prototype.toJSON=function(){return{x:this.x,y:this.y}},o.prototype.clone=function(){return new o(this.x,this.y)},o.prototype.set_zero=function(){return this.x=0,this.y=0,this},o.prototype.set=function(t,e){return this.x=+t||0,this.y=+e||0,this},o.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},o.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},o.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},o.prototype.mul=function(t){return this.x*=t,this.y*=t,this},o.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},o.prototype.normalize=function(){var t=this.length();return this.x/=t,this.y/=t,t},o.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},o.negate=function(t){return new o(-t.x,-t.y)},o.add=function(t,e){return new o(t.x+e.x,t.y+e.y)},o.sub=function(t,e){return new o(t.x-e.x,t.y-e.y)},o.mul=function(t,e){return new o(t*e.x,t*e.y)},o.cross=function(t,e){return"number"==typeof t?"number"==typeof e?t*e:new o(-t*e.y,t*e.x):"number"==typeof e?new o(e*t.y,-e*t.x):t.x*e.y-t.y*e.x},o.toString=i.toString,o.compare=i.compare,o.cmp=i.compare,o.equals=i.equals,o.dot=function(t,e){return t.x*e.x+t.y*e.y},e.exports=o},{"./xy":11}],5:[function(t,e,n){"use strict";var i=t("./xy"),o=function(t,e){this.name="PointError",this.points=e=e||[],this.message=t||"Invalid Points!";for(var n=0;n<e.length;n++)this.message+=" "+i.toString(e[n])};o.prototype=new Error,o.prototype.constructor=o,e.exports=o},{"./xy":11}],6:[function(t,e,n){(function(e){"use strict";var i=e.poly2tri;n.noConflict=function(){return e.poly2tri=i,n},n.VERSION=t("../dist/version.json").version,n.PointError=t("./pointerror"),n.Point=t("./point"),n.Triangle=t("./triangle"),n.SweepContext=t("./sweepcontext");var o=t("./sweep");n.triangulate=o.triangulate,n.sweep={Triangulate:o.triangulate}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../dist/version.json":1,"./point":4,"./pointerror":5,"./sweep":7,"./sweepcontext":8,"./triangle":9}],7:[function(t,e,n){"use strict";function i(t){t.initTriangulation(),t.createAdvancingFront(),o(t),r(t)}function o(t){var e,n=t.pointCount();for(e=1;n>e;++e)for(var i=t.getPoint(e),o=s(t,i),r=i._p2t_edge_list,u=0;r&&u<r.length;++u)a(t,r[u],o)}function r(t){for(var e=t.front().head().next.triangle,n=t.front().head().next.point;!e.getConstrainedEdgeCW(n);)e=e.neighborCCW(n);t.meshClean(e)}function s(t,e){var n=t.locateNode(e),i=l(t,e,n);return e.x<=n.point.x+U&&p(t,n),c(t,i),i}function a(t,e,n){t.edge_event.constrained_edge=e,t.edge_event.right=e.p.x>e.q.x,h(n.triangle,e.p,e.q)||(m(t,e,n),u(t,e.p,e.q,n.triangle,e.q))}function u(t,e,n,i,o){if(!h(i,e,n)){var r=i.pointCCW(o),s=B(n,r,e);if(s===W.COLLINEAR)throw new N("poly2tri EdgeEvent: Collinear not supported!",[n,r,e]);var a=i.pointCW(o),l=B(n,a,e);if(l===W.COLLINEAR)throw new N("poly2tri EdgeEvent: Collinear not supported!",[n,a,e]);s===l?(i=s===W.CW?i.neighborCCW(o):i.neighborCW(o),u(t,e,n,i,o)):T(t,e,n,i,o)}}function h(t,e,n){var i=t.edgeIndex(e,n);if(-1!==i){t.markConstrainedEdgeByIndex(i);var o=t.getNeighbor(i);return o&&o.markConstrainedEdgeByPoints(e,n),!0}return!1}function l(t,e,n){var i=new I(e,n.point,n.next.point);i.markNeighbor(n.triangle),t.addToMap(i);var o=new M(e);return o.next=n.next,o.prev=n,n.next.prev=o,n.next=o,f(t,i)||t.mapTriangleToNodes(i),o}function p(t,e){var n=new I(e.prev.point,e.point,e.next.point);n.markNeighbor(e.prev.triangle),n.markNeighbor(e.triangle),t.addToMap(n),e.prev.next=e.next,e.next.prev=e.prev,f(t,n)||t.mapTriangleToNodes(n)}function c(t,e){for(var n=e.next;n.next&&!k(n.point,n.next.point,n.prev.point);)p(t,n),n=n.next;for(n=e.prev;n.prev&&!k(n.point,n.next.point,n.prev.point);)p(t,n),n=n.prev;e.next&&e.next.next&&d(e)&&x(t,e)}function d(t){var e=t.point.x-t.next.next.point.x,n=t.point.y-t.next.next.point.y;return D(n>=0,"unordered y"),e>=0||Math.abs(e)<n}function f(t,e){for(var n=0;3>n;++n)if(!e.delaunay_edge[n]){var i=e.getNeighbor(n);if(i){var o=e.getPoint(n),r=i.oppositePoint(e,o),s=i.index(r);if(i.constrained_edge[s]||i.delaunay_edge[s]){e.constrained_edge[n]=i.constrained_edge[s];continue}var a=g(o,e.pointCCW(o),e.pointCW(o),r);if(a){e.delaunay_edge[n]=!0,i.delaunay_edge[s]=!0,y(e,o,i,r);var u=!f(t,e);return u&&t.mapTriangleToNodes(e),u=!f(t,i),u&&t.mapTriangleToNodes(i),e.delaunay_edge[n]=!1,i.delaunay_edge[s]=!1,!0}}}return!1}function g(t,e,n,i){var o=t.x-i.x,r=t.y-i.y,s=e.x-i.x,a=e.y-i.y,u=o*a,h=s*r,l=u-h;if(0>=l)return!1;var p=n.x-i.x,c=n.y-i.y,d=p*r,f=o*c,g=d-f;if(0>=g)return!1;var y=s*c,x=p*a,_=o*o+r*r,v=s*s+a*a,m=p*p+c*c,A=_*(y-x)+v*g+m*l;return A>0}function y(t,e,n,i){var o,r,s,a;o=t.neighborCCW(e),r=t.neighborCW(e),s=n.neighborCCW(i),a=n.neighborCW(i);var u,h,l,p;u=t.getConstrainedEdgeCCW(e),h=t.getConstrainedEdgeCW(e),l=n.getConstrainedEdgeCCW(i),p=n.getConstrainedEdgeCW(i);var c,d,f,g;c=t.getDelaunayEdgeCCW(e),d=t.getDelaunayEdgeCW(e),f=n.getDelaunayEdgeCCW(i),g=n.getDelaunayEdgeCW(i),t.legalize(e,i),n.legalize(i,e),n.setDelaunayEdgeCCW(e,c),t.setDelaunayEdgeCW(e,d),t.setDelaunayEdgeCCW(i,f),n.setDelaunayEdgeCW(i,g),n.setConstrainedEdgeCCW(e,u),t.setConstrainedEdgeCW(e,h),t.setConstrainedEdgeCCW(i,l),n.setConstrainedEdgeCW(i,p),t.clearNeighbors(),n.clearNeighbors(),o&&n.markNeighbor(o),r&&t.markNeighbor(r),s&&t.markNeighbor(s),a&&n.markNeighbor(a),t.markNeighbor(n)}function x(t,e){for(t.basin.left_node=B(e.point,e.next.point,e.next.next.point)===W.CCW?e.next.next:e.next,t.basin.bottom_node=t.basin.left_node;t.basin.bottom_node.next&&t.basin.bottom_node.point.y>=t.basin.bottom_node.next.point.y;)t.basin.bottom_node=t.basin.bottom_node.next;if(t.basin.bottom_node!==t.basin.left_node){for(t.basin.right_node=t.basin.bottom_node;t.basin.right_node.next&&t.basin.right_node.point.y<t.basin.right_node.next.point.y;)t.basin.right_node=t.basin.right_node.next;t.basin.right_node!==t.basin.bottom_node&&(t.basin.width=t.basin.right_node.point.x-t.basin.left_node.point.x,t.basin.left_highest=t.basin.left_node.point.y>t.basin.right_node.point.y,_(t,t.basin.bottom_node))}}function _(t,e){if(!v(t,e)){p(t,e);var n;if(e.prev!==t.basin.left_node||e.next!==t.basin.right_node){if(e.prev===t.basin.left_node){if(n=B(e.point,e.next.point,e.next.next.point),n===W.CW)return;e=e.next}else if(e.next===t.basin.right_node){if(n=B(e.point,e.prev.point,e.prev.prev.point),n===W.CCW)return;e=e.prev}else e=e.prev.point.y<e.next.point.y?e.prev:e.next;_(t,e)}}}function v(t,e){var n;return n=t.basin.left_highest?t.basin.left_node.point.y-e.point.y:t.basin.right_node.point.y-e.point.y,t.basin.width>n?!0:!1}function m(t,e,n){t.edge_event.right?A(t,e,n):O(t,e,n)}function A(t,e,n){for(;n.next.point.x<e.p.x;)B(e.q,n.next.point,e.p)===W.CCW?L(t,e,n):n=n.next}function L(t,e,n){n.point.x<e.p.x&&(B(n.point,n.next.point,n.next.next.point)===W.CCW?C(t,e,n):(w(t,e,n),L(t,e,n)))}function C(t,e,n){p(t,n.next),n.next.point!==e.p&&B(e.q,n.next.point,e.p)===W.CCW&&B(n.point,n.next.point,n.next.next.point)===W.CCW&&C(t,e,n)}function w(t,e,n){B(n.next.point,n.next.next.point,n.next.next.next.point)===W.CCW?C(t,e,n.next):B(e.q,n.next.next.point,e.p)===W.CCW&&w(t,e,n.next)}function O(t,e,n){for(;n.prev.point.x>e.p.x;)B(e.q,n.prev.point,e.p)===W.CW?b(t,e,n):n=n.prev}function b(t,e,n){n.point.x>e.p.x&&(B(n.point,n.prev.point,n.prev.prev.point)===W.CW?E(t,e,n):(G(t,e,n),b(t,e,n)))}function G(t,e,n){B(n.prev.point,n.prev.prev.point,n.prev.prev.prev.point)===W.CW?E(t,e,n.prev):B(e.q,n.prev.prev.point,e.p)===W.CW&&G(t,e,n.prev)}function E(t,e,n){p(t,n.prev),n.prev.point!==e.p&&B(e.q,n.prev.point,e.p)===W.CW&&B(n.point,n.prev.point,n.prev.prev.point)===W.CW&&E(t,e,n)}function T(t,e,n,i,o){var r=i.neighborAcross(o);D(r,"FLIP failed due to missing triangle!");var s=r.oppositePoint(i,o);if(i.getConstrainedEdgeAcross(o)){var a=i.index(o);throw new N("poly2tri Intersecting Constraints",[o,s,i.getPoint((a+1)%3),i.getPoint((a+2)%3)])}if(F(o,i.pointCCW(o),i.pointCW(o),s))if(y(i,o,r,s),t.mapTriangleToNodes(i),t.mapTriangleToNodes(r),o===n&&s===e)n===t.edge_event.constrained_edge.q&&e===t.edge_event.constrained_edge.p&&(i.markConstrainedEdgeByPoints(e,n),r.markConstrainedEdgeByPoints(e,n),f(t,i),f(t,r));else{var h=B(n,s,e);i=S(t,h,i,r,o,s),T(t,e,n,i,o)}else{var l=R(e,n,r,s);P(t,e,n,i,r,l),u(t,e,n,i,o)}}function S(t,e,n,i,o,r){var s;return e===W.CCW?(s=i.edgeIndex(o,r),i.delaunay_edge[s]=!0,f(t,i),i.clearDelaunayEdges(),n):(s=n.edgeIndex(o,r),n.delaunay_edge[s]=!0,f(t,n),n.clearDelaunayEdges(),i)}function R(t,e,n,i){var o=B(e,i,t);if(o===W.CW)return n.pointCCW(i);if(o===W.CCW)return n.pointCW(i);throw new N("poly2tri [Unsupported] nextFlipPoint: opposing point on constrained edge!",[e,i,t])}function P(t,e,n,i,o,r){var s=o.neighborAcross(r);D(s,"FLIP failed due to missing triangle");var a=s.oppositePoint(o,r);if(F(n,i.pointCCW(n),i.pointCW(n),a))T(t,n,a,s,a);else{var u=R(e,n,s,a);P(t,e,n,i,s,u)}}var D=t("./assert"),N=t("./pointerror"),I=t("./triangle"),M=t("./advancingfront").Node,q=t("./utils"),U=q.EPSILON,W=q.Orientation,B=q.orient2d,F=q.inScanArea,k=q.isAngleObtuse;n.triangulate=i},{"./advancingfront":2,"./assert":3,"./pointerror":5,"./triangle":9,"./utils":10}],8:[function(t,e,n){"use strict";var i=t("./pointerror"),o=t("./point"),r=t("./triangle"),s=t("./sweep"),a=t("./advancingfront"),u=a.Node,h=.3,l=function(t,e){if(this.p=t,this.q=e,t.y>e.y)this.q=t,this.p=e;else if(t.y===e.y)if(t.x>e.x)this.q=t,this.p=e;else if(t.x===e.x)throw new i("poly2tri Invalid Edge constructor: repeated points!",[t]);this.q._p2t_edge_list||(this.q._p2t_edge_list=[]),this.q._p2t_edge_list.push(this)},p=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};p.prototype.clear=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};var c=function(){this.constrained_edge=null,this.right=!1},d=function(t,e){e=e||{},this.triangles_=[],this.map_=[],this.points_=e.cloneArrays?t.slice(0):t,this.edge_list=[],this.pmin_=this.pmax_=null,this.front_=null,this.head_=null,this.tail_=null,this.af_head_=null,this.af_middle_=null,this.af_tail_=null,this.basin=new p,this.edge_event=new c,this.initEdges(this.points_)};d.prototype.addHole=function(t){this.initEdges(t);var e,n=t.length;for(e=0;n>e;e++)this.points_.push(t[e]);return this},d.prototype.AddHole=d.prototype.addHole,d.prototype.addHoles=function(t){var e,n=t.length;for(e=0;n>e;e++)this.initEdges(t[e]);return this.points_=this.points_.concat.apply(this.points_,t),this},d.prototype.addPoint=function(t){return this.points_.push(t),this},d.prototype.AddPoint=d.prototype.addPoint,d.prototype.addPoints=function(t){return this.points_=this.points_.concat(t),this},d.prototype.triangulate=function(){return s.triangulate(this),this},d.prototype.getBoundingBox=function(){return{min:this.pmin_,max:this.pmax_}},d.prototype.getTriangles=function(){return this.triangles_},d.prototype.GetTriangles=d.prototype.getTriangles,d.prototype.front=function(){return this.front_},d.prototype.pointCount=function(){return this.points_.length},d.prototype.head=function(){return this.head_},d.prototype.setHead=function(t){this.head_=t},d.prototype.tail=function(){return this.tail_},d.prototype.setTail=function(t){this.tail_=t},d.prototype.getMap=function(){return this.map_},d.prototype.initTriangulation=function(){var t,e=this.points_[0].x,n=this.points_[0].x,i=this.points_[0].y,r=this.points_[0].y,s=this.points_.length;for(t=1;s>t;t++){var a=this.points_[t];a.x>e&&(e=a.x),a.x<n&&(n=a.x),a.y>i&&(i=a.y),a.y<r&&(r=a.y)}this.pmin_=new o(n,r),this.pmax_=new o(e,i);var u=h*(e-n),l=h*(i-r);this.head_=new o(e+u,r-l),this.tail_=new o(n-u,r-l),this.points_.sort(o.compare)},d.prototype.initEdges=function(t){var e,n=t.length;for(e=0;n>e;++e)this.edge_list.push(new l(t[e],t[(e+1)%n]))},d.prototype.getPoint=function(t){return this.points_[t]},d.prototype.addToMap=function(t){this.map_.push(t)},d.prototype.locateNode=function(t){return this.front_.locateNode(t.x)},d.prototype.createAdvancingFront=function(){var t,e,n,i=new r(this.points_[0],this.tail_,this.head_);this.map_.push(i),t=new u(i.getPoint(1),i),e=new u(i.getPoint(0),i),n=new u(i.getPoint(2)),this.front_=new a(t,n),t.next=e,e.next=n,e.prev=t,n.prev=e},d.prototype.removeNode=function(t){},d.prototype.mapTriangleToNodes=function(t){for(var e=0;3>e;++e)if(!t.getNeighbor(e)){var n=this.front_.locatePoint(t.pointCW(t.getPoint(e)));n&&(n.triangle=t)}},d.prototype.removeFromMap=function(t){var e,n=this.map_,i=n.length;for(e=0;i>e;e++)if(n[e]===t){n.splice(e,1);break}},d.prototype.meshClean=function(t){for(var e,n,i=[t];e=i.pop();)if(!e.isInterior())for(e.setInterior(!0),this.triangles_.push(e),n=0;3>n;n++)e.constrained_edge[n]||i.push(e.getNeighbor(n))},e.exports=d},{"./advancingfront":2,"./point":4,"./pointerror":5,"./sweep":7,"./triangle":9}],9:[function(t,e,n){"use strict";var i=t("./xy"),o=function(t,e,n){this.points_=[t,e,n],this.neighbors_=[null,null,null],this.interior_=!1,this.constrained_edge=[!1,!1,!1],this.delaunay_edge=[!1,!1,!1]},r=i.toString;o.prototype.toString=function(){return"["+r(this.points_[0])+r(this.points_[1])+r(this.points_[2])+"]"},o.prototype.getPoint=function(t){return this.points_[t]},o.prototype.GetPoint=o.prototype.getPoint,o.prototype.getPoints=function(){return this.points_},o.prototype.getNeighbor=function(t){return this.neighbors_[t]},o.prototype.containsPoint=function(t){var e=this.points_;return t===e[0]||t===e[1]||t===e[2]},o.prototype.containsEdge=function(t){return this.containsPoint(t.p)&&this.containsPoint(t.q)},o.prototype.containsPoints=function(t,e){return this.containsPoint(t)&&this.containsPoint(e)},o.prototype.isInterior=function(){return this.interior_},o.prototype.setInterior=function(t){return this.interior_=t,this},o.prototype.markNeighborPointers=function(t,e,n){var i=this.points_;if(t===i[2]&&e===i[1]||t===i[1]&&e===i[2])this.neighbors_[0]=n;else if(t===i[0]&&e===i[2]||t===i[2]&&e===i[0])this.neighbors_[1]=n;else{if(!(t===i[0]&&e===i[1]||t===i[1]&&e===i[0]))throw new Error("poly2tri Invalid Triangle.markNeighborPointers() call");this.neighbors_[2]=n}},o.prototype.markNeighbor=function(t){var e=this.points_;t.containsPoints(e[1],e[2])?(this.neighbors_[0]=t,t.markNeighborPointers(e[1],e[2],this)):t.containsPoints(e[0],e[2])?(this.neighbors_[1]=t,t.markNeighborPointers(e[0],e[2],this)):t.containsPoints(e[0],e[1])&&(this.neighbors_[2]=t,t.markNeighborPointers(e[0],e[1],this))},o.prototype.clearNeighbors=function(){this.neighbors_[0]=null,this.neighbors_[1]=null,this.neighbors_[2]=null},o.prototype.clearDelaunayEdges=function(){this.delaunay_edge[0]=!1,this.delaunay_edge[1]=!1,this.delaunay_edge[2]=!1},o.prototype.pointCW=function(t){var e=this.points_;return t===e[0]?e[2]:t===e[1]?e[0]:t===e[2]?e[1]:null},o.prototype.pointCCW=function(t){var e=this.points_;return t===e[0]?e[1]:t===e[1]?e[2]:t===e[2]?e[0]:null},o.prototype.neighborCW=function(t){return t===this.points_[0]?this.neighbors_[1]:t===this.points_[1]?this.neighbors_[2]:this.neighbors_[0]},o.prototype.neighborCCW=function(t){return t===this.points_[0]?this.neighbors_[2]:t===this.points_[1]?this.neighbors_[0]:this.neighbors_[1]},o.prototype.getConstrainedEdgeCW=function(t){return t===this.points_[0]?this.constrained_edge[1]:t===this.points_[1]?this.constrained_edge[2]:this.constrained_edge[0]},o.prototype.getConstrainedEdgeCCW=function(t){return t===this.points_[0]?this.constrained_edge[2]:t===this.points_[1]?this.constrained_edge[0]:this.constrained_edge[1]},o.prototype.getConstrainedEdgeAcross=function(t){return t===this.points_[0]?this.constrained_edge[0]:t===this.points_[1]?this.constrained_edge[1]:this.constrained_edge[2]},o.prototype.setConstrainedEdgeCW=function(t,e){t===this.points_[0]?this.constrained_edge[1]=e:t===this.points_[1]?this.constrained_edge[2]=e:this.constrained_edge[0]=e},o.prototype.setConstrainedEdgeCCW=function(t,e){t===this.points_[0]?this.constrained_edge[2]=e:t===this.points_[1]?this.constrained_edge[0]=e:this.constrained_edge[1]=e},o.prototype.getDelaunayEdgeCW=function(t){return t===this.points_[0]?this.delaunay_edge[1]:t===this.points_[1]?this.delaunay_edge[2]:this.delaunay_edge[0]},o.prototype.getDelaunayEdgeCCW=function(t){return t===this.points_[0]?this.delaunay_edge[2]:t===this.points_[1]?this.delaunay_edge[0]:this.delaunay_edge[1]},o.prototype.setDelaunayEdgeCW=function(t,e){t===this.points_[0]?this.delaunay_edge[1]=e:t===this.points_[1]?this.delaunay_edge[2]=e:this.delaunay_edge[0]=e},o.prototype.setDelaunayEdgeCCW=function(t,e){t===this.points_[0]?this.delaunay_edge[2]=e:t===this.points_[1]?this.delaunay_edge[0]=e:this.delaunay_edge[1]=e},o.prototype.neighborAcross=function(t){return t===this.points_[0]?this.neighbors_[0]:t===this.points_[1]?this.neighbors_[1]:this.neighbors_[2]},o.prototype.oppositePoint=function(t,e){var n=t.pointCW(e);return this.pointCW(n)},o.prototype.legalize=function(t,e){var n=this.points_;if(t===n[0])n[1]=n[0],n[0]=n[2],n[2]=e;else if(t===n[1])n[2]=n[1],n[1]=n[0],n[0]=e;else{if(t!==n[2])throw new Error("poly2tri Invalid Triangle.legalize() call");n[0]=n[2],n[2]=n[1],n[1]=e}},o.prototype.index=function(t){var e=this.points_;if(t===e[0])return 0;if(t===e[1])return 1;if(t===e[2])return 2;throw new Error("poly2tri Invalid Triangle.index() call")},o.prototype.edgeIndex=function(t,e){var n=this.points_;if(t===n[0]){if(e===n[1])return 2;if(e===n[2])return 1}else if(t===n[1]){if(e===n[2])return 0;if(e===n[0])return 2}else if(t===n[2]){if(e===n[0])return 1;if(e===n[1])return 0}return-1},o.prototype.markConstrainedEdgeByIndex=function(t){this.constrained_edge[t]=!0},o.prototype.markConstrainedEdgeByEdge=function(t){this.markConstrainedEdgeByPoints(t.p,t.q)},o.prototype.markConstrainedEdgeByPoints=function(t,e){var n=this.points_;e===n[0]&&t===n[1]||e===n[1]&&t===n[0]?this.constrained_edge[2]=!0:e===n[0]&&t===n[2]||e===n[2]&&t===n[0]?this.constrained_edge[1]=!0:(e===n[1]&&t===n[2]||e===n[2]&&t===n[1])&&(this.constrained_edge[0]=!0)},e.exports=o},{"./xy":11}],10:[function(t,e,n){"use strict";function i(t,e,n){var i=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),r=i-o;return r>-s&&s>r?a.COLLINEAR:r>0?a.CCW:a.CW}function o(t,e,n,i){var o=(t.x-e.x)*(i.y-e.y)-(i.x-e.x)*(t.y-e.y);if(o>=-s)return!1;var r=(t.x-n.x)*(i.y-n.y)-(i.x-n.x)*(t.y-n.y);return s>=r?!1:!0}function r(t,e,n){var i=e.x-t.x,o=e.y-t.y,r=n.x-t.x,s=n.y-t.y;return 0>i*r+o*s}var s=1e-12;n.EPSILON=s;var a={CW:1,CCW:-1,COLLINEAR:0};n.Orientation=a,n.orient2d=i,n.inScanArea=o,n.isAngleObtuse=r},{}],11:[function(t,e,n){"use strict";function i(t){return"("+t.x+";"+t.y+")"}function o(t){var e=t.toString();return"[object Object]"===e?i(t):e}function r(t,e){return t.y===e.y?t.x-e.x:t.y-e.y}function s(t,e){return t.x===e.x&&t.y===e.y}e.exports={toString:o,toStringBase:i,compare:r,equals:s}},{}]},{},[6])(6)}),BufferLoader.prototype.loadBuffer=function(t,e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer";var i=this;n.onload=function(){i.context.decodeAudioData(n.response,function(n){return n?(i.bufferList[e]=n,void(++i.loadCount==i.urlList.length&&i.onload(i.bufferList))):void alert("error decoding file data: "+t)},function(t){console.error("decodeAudioData error",t)})},n.onerror=function(){alert("BufferLoader: XHR error")},n.send()},BufferLoader.prototype.load=function(){for(var t=0;t<this.urlList.length;++t)this.loadBuffer(this.urlList[t],t)},FlowCalculator.prototype.calculate=function(t,e,n,i){var o,r,s,a,u,h,l,p,c,d=[],f=this.step,g=2*f+1;p=c=0;var y,x,_,v,m=n-f-1,A=i-f-1;for(y=f+1;A>y;y+=g)for(x=f+1;m>x;x+=g){for(o=r=s=a=u=0,_=-f;f>=_;_++)for(v=-f;f>=v;v++){var L=(y+_)*n+x+v,C=e[4*(L-1)]-e[4*(L+1)],w=e[4*(L-n)]-e[4*(L+n)],O=t[4*L]-e[4*L];o+=C*C,r+=C*w,s+=w*w,u+=C*O,a+=w*O}var b=r*r-o*s;if(0!==b){var G=f/b,E=-(a*r-u*s),T=-(r*u-o*a);h=E*G,l=T*G}else{var S=(r+o)*(r+o)+(s+r)*(s+r);if(0!==S){var R=f/S,P=-(a+u)*R;h=(r+o)*P,l=(s+r)*P}else h=l=0}h>-g&&g>h&&l>-g&&g>l&&(p+=h,c+=l,d.push(new FlowZone(x,y,h,l)))}return{zones:d,u:p/d.length,v:c/d.length}};/*!*
 * algo.js
 *
 * JavaScript Creative Coding Framework
 * http://algojs.com
 *
 * Copyright 2015 hisa hayashi, HYS INC.
 */
var ALGO=function(){"use strict";function t(n){O=this,b=t.ObjectUtil.extend(param,n),e()}function e(){n(),i(),r()}function n(){O.width=b.width,O.height=b.height,O.backgroundAuto=param.backgroundAuto,t.log(O)}function i(){O.render=new t.Render(O),O.render.setFramerate(O.framerate)}function o(){O.canvas=document.getElementById(b.id),O.canvas.width=b.width,O.canvas.height=b.height,O.renderer=new t.WebGLRenderer(O)}function r(){window.onload=function(){o(),O.setup&&O.setup.call(O),s()}}function s(){window.onmouseover=function(){O.mouseover&&O.mouseover.call(O)},window.onmouseout=function(){O.mouseout&&O.mouseout.call(O)},window.onmousedown=function(){O.mousedown&&O.mousedown.call(O)},window.onmouseup=function(){O.mouseup&&O.mouseup.call(O)},window.onmousemove=function(t){if(O.mousemove){var e=t.clientX,n=t.clientY;O.mousemove.call(O,e,n)}},window.onkeydown=function(){O.keydown&&O.keydown.call(O)},window.onkeyup=function(){O.keyup&&O.keyup.call(O)},window.onresize=function(){O.resize&&O.resize.call(O),O.renderer&&O.renderer.resize()},O.render.startRender()}function a(t,e){this[t]=e,O[t]=this[t],O=this}function u(t,e){this[t]=e,O[t]=null}function h(){}function l(){}function p(){}function c(){}function d(){}function f(){}function g(){}function y(){}function x(){}function _(){}function v(){}function m(t,e){O.canvas.width=t,O.canvas.height=e,O.width=t,O.height=e}function A(t){t.add(O)}function L(t){t.remove(O)}function C(t,e,n,i){void 0==t&&(t=0),void 0==e&&(e=0),void 0==n&&(n=this.width),void 0==i&&(i=this.height);var o=this.renderer.getContext(),r=new Uint8Array(n*i*4);o.readPixels(t,e,n,i,o.RGBA,o.UNSIGNED_BYTE,r);for(var s=new Uint8Array(n*i*4),a=0;i>a;a++){var u=(i-a)*n*4,h=a*n*4,l=r.slice(u,u+4*n);s.set(new Uint8Array(l),h)}return s}function w(t){this.backgroundAuto=t,this.renderer&&this.renderer.init(this)}var O,b={id:"",width:window.innerWidth,height:window.innerHeight,backgroundAuto:!0};return t.prototype={constructor:t,setup:h,frame:l,destroy:p,mouseover:c,mouseout:d,mousedown:f,mouseup:g,mousemove:y,keydown:x,keyup:_,resize:v,bind:a,unbind:u,size:m,add:A,remove:L,readPixels:C,setBackgroundAuto:w,render:null,renderer:null},t}();ALGO.debug=1,ALGO.BLEND_NONE=0,ALGO.BLEND_ADD=1,ALGO.BLEND_MULTIPLY=2,ALGO.BLEND_SCREEN=3,ALGO.BLEND_ALPHA=4,ALGO.prototype.__defineGetter__("framerate",function(){return this.framerate_}),ALGO.prototype.__defineSetter__("framerate",function(t){this.render&&this.render.setFramerate(t),this.framerate_=t}),ALGO.prototype.__defineGetter__("circleResolution",function(){return this.circleResolution_}),ALGO.prototype.__defineSetter__("circleResolution",function(t){ALGO.circleResolution=t,this.circleResolution_=t}),ALGO.prototype.width=0,ALGO.prototype.height=0,ALGO.prototype.blendMode=ALGO.BLEND_ALPHA,ALGO.prototype.background=6710886,ALGO.prototype.backgroundAlpha=.5,ALGO.prototype.backgroundAuto=!0,ALGO.prototype.framerate=60,ALGO.prototype.circleResolution=32,ALGO.prototype.canvas=null,ALGO.prototype.displayObjects=[],ALGO.prototype.children=[],ALGO.Render=function(){"use strict";function t(){e(),n()}function e(){}function n(){}function i(t){h=t,l=1e3/h,ALGO.log("setFramerate = "+h)}function o(){return h}function r(){g=!0,l=1e3/h,d=Date.now(),p=d,a()}function s(){g=!1}function a(){if(g&&x(a),c=Date.now(),f=c-d,f>l){d=c-f%l,u.renderer&&u.renderer.update(),u.frame&&u.frame.call(u);{var t=c-p;Math.round(1e3/(t/++y)*100)/100}}}var u,h,l,p,c,d,f,g=!1,y=0,x=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/h)};return ALGO.Render=function(e){u=e,t()},ALGO.Render.prototype={constructor:ALGO.Render,setFramerate:i,getFramerate:o,startRender:r,stopRender:s},ALGO.Render}(),ALGO.Matrix3=function(t){"use strict";function e(){return new Float32Array(16)}function n(t){return t=[1,0,0,0,1,0,0,0,1]}function i(t,e,n){var i=t[0],o=t[1],r=t[2],s=t[3],a=t[4],u=t[5],h=t[6],l=t[7],p=t[8],c=e[0],d=e[1],f=e[2],g=e[3],y=e[4],x=e[5],_=e[6],v=e[7],m=e[8];return n[0]=i*c+o*g+r*_,n[1]=i*d+o*y+r*v,n[2]=i*f+o*x+r*m,n[3]=s*c+a*g+u*_,n[4]=s*d+a*y+u*v,n[5]=s*f+a*x+u*m,n[6]=h*c+l*g+p*_,n[7]=h*d+l*y+p*v,n[8]=h*f+l*x+p*m,n}function o(t,e,n){return n[0]=t[0]*e[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4]*e[1],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n}function r(t,e,n){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6]+e[0],n[7]=t[7]+e[1],n[8]=t[8],n}function s(t,e,n){var i=Math.cos(e),o=Math.sin(e);return n[0]=i,n[1]=-o,n[2]=t[2],n[3]=o,n[4]=i,n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n}function a(t,e){return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],e}function u(t,e){return e}return t.Matrix3=function(){},t.Matrix3.prototype={constructor:t.Matrix3,create:e,identity:n,multiply:i,scale:o,translate:r,rotate:s,transpose:a,inverse:u},t.Matrix3}(ALGO),ALGO.Matrix4=function(t){"use strict";function e(){return new Float32Array(16)}function n(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function i(t,e,n){var i=t[0],o=t[1],r=t[2],s=t[3],a=t[4],u=t[5],h=t[6],l=t[7],p=t[8],c=t[9],d=t[10],f=t[11],g=t[12],y=t[13],x=t[14],_=t[15],v=e[0],m=e[1],A=e[2],L=e[3],C=e[4],w=e[5],O=e[6],b=e[7],G=e[8],E=e[9],T=e[10],S=e[11],R=e[12],P=e[13],D=e[14],N=e[15];return n[0]=v*i+m*a+A*p+L*g,n[1]=v*o+m*u+A*c+L*y,n[2]=v*r+m*h+A*d+L*x,n[3]=v*s+m*l+A*f+L*_,n[4]=C*i+w*a+O*p+b*g,n[5]=C*o+w*u+O*c+b*y,n[6]=C*r+w*h+O*d+b*x,n[7]=C*s+w*l+O*f+b*_,n[8]=G*i+E*a+T*p+S*g,n[9]=G*o+E*u+T*c+S*y,n[10]=G*r+E*h+T*d+S*x,n[11]=G*s+E*l+T*f+S*_,n[12]=R*i+P*a+D*p+N*g,n[13]=R*o+P*u+D*c+N*y,n[14]=R*r+P*h+D*d+N*x,n[15]=R*s+P*l+D*f+N*_,n}function o(t,e,n){return n[0]=t[0]*e[0],n[1]=t[1]*e[0],n[2]=t[2]*e[0],n[3]=t[3]*e[0],n[4]=t[4]*e[1],n[5]=t[5]*e[1],n[6]=t[6]*e[1],n[7]=t[7]*e[1],n[8]=t[8]*e[2],n[9]=t[9]*e[2],n[10]=t[10]*e[2],n[11]=t[11]*e[2],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function r(t,e,n){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12],n[13]=t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13],n[14]=t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14],n[15]=t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15],n}function s(t,e,n,i){var o=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);if(!o)return null;var r=n[0],s=n[1],a=n[2];1!=o&&(o=1/o,r*=o,s*=o,a*=o);var u=Math.sin(e),h=Math.cos(e),l=1-h,p=t[0],c=t[1],d=t[2],f=t[3],g=t[4],y=t[5],x=t[6],_=t[7],v=t[8],m=t[9],A=t[10],L=t[11],C=r*r*l+h,w=s*r*l+a*u,O=a*r*l-s*u,b=r*s*l-a*u,G=s*s*l+h,E=a*s*l+r*u,T=r*a*l+s*u,S=s*a*l-r*u,R=a*a*l+h;return e?t!=i&&(i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]):i=t,i[0]=p*C+g*w+v*O,i[1]=c*C+y*w+m*O,i[2]=d*C+x*w+A*O,i[3]=f*C+_*w+L*O,i[4]=p*b+g*G+v*E,i[5]=c*b+y*G+m*E,i[6]=d*b+x*G+A*E,i[7]=f*b+_*G+L*E,i[8]=p*T+g*S+v*R,i[9]=c*T+y*S+m*R,i[10]=d*T+x*S+A*R,i[11]=f*T+_*S+L*R,i}function a(t,e,i,o){var r=t[0],s=t[1],a=t[2],u=i[0],h=i[1],l=i[2],p=e[0],c=e[1],d=e[2];if(r==p&&s==c&&a==d)return n(o);var f,g,y,x,_,v,m,A,L,C;return m=r-e[0],A=s-e[1],L=a-e[2],C=1/Math.sqrt(m*m+A*A+L*L),m*=C,A*=C,L*=C,f=h*L-l*A,g=l*m-u*L,y=u*A-h*m,C=Math.sqrt(f*f+g*g+y*y),C?(C=1/C,f*=C,g*=C,y*=C):(f=0,g=0,y=0),x=A*y-L*g,_=L*f-m*y,v=m*g-A*f,C=Math.sqrt(x*x+_*_+v*v),C?(C=1/C,x*=C,_*=C,v*=C):(x=0,_=0,v=0),o[0]=f,o[1]=x,o[2]=m,o[3]=0,o[4]=g,o[5]=_,o[6]=A,o[7]=0,o[8]=y,o[9]=v,o[10]=L,o[11]=0,o[12]=-(f*r+g*s+y*a),o[13]=-(x*r+_*s+v*a),o[14]=-(m*r+A*s+L*a),o[15]=1,o}function u(t,e,n,i,o){var r=n*Math.tan(t*Math.PI/360),s=r*e,a=2*s,u=2*r,h=i-n;return o[0]=2*n/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*n/u,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-(i+n)/h,o[11]=-1,o[12]=0,o[13]=0,o[14]=-(i*n*2)/h,o[15]=0,o}function h(t,e){return e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e}function l(t,e){var n=t[0],i=t[1],o=t[2],r=t[3],s=t[4],a=t[5],u=t[6],h=t[7],l=t[8],p=t[9],c=t[10],d=t[11],f=t[12],g=t[13],y=t[14],x=t[15],_=n*a-i*s,v=n*u-o*s,m=n*h-r*s,A=i*u-o*a,L=i*h-r*a,C=o*h-r*u,w=l*g-p*f,O=l*y-c*f,b=l*x-d*f,G=p*y-c*g,E=p*x-d*g,T=c*x-d*y,S=1/(_*T-v*E+m*G+A*b-L*O+C*w);return e[0]=(a*T-u*E+h*G)*S,e[1]=(-i*T+o*E-r*G)*S,e[2]=(g*C-y*L+x*A)*S,e[3]=(-p*C+c*L-d*A)*S,e[4]=(-s*T+u*b-h*O)*S,e[5]=(n*T-o*b+r*O)*S,e[6]=(-f*C+y*m-x*v)*S,e[7]=(l*C-c*m+d*v)*S,e[8]=(s*E-a*b+h*w)*S,e[9]=(-n*E+i*b-r*w)*S,e[10]=(f*L-g*m+x*_)*S,e[11]=(-l*L+p*m-d*_)*S,e[12]=(-s*G+a*O-u*w)*S,e[13]=(n*G-i*O+o*w)*S,e[14]=(-f*A+g*v-y*_)*S,e[15]=(l*A-p*v+c*_)*S,e}return t.Matrix4=function(){},t.Matrix4.prototype={constructor:t.Matrix4,create:e,identity:n,multiply:i,scale:o,translate:r,rotate:s,lookAt:a,perspective:u,transpose:h,inverse:l},t.Matrix4}(ALGO),ALGO.Loader=function(){"use strict";function t(){this.xhr.open("get",this.loaderURL,!0),this.xhr.send(null)}function e(t){this.xhr.open("post",this.loaderURL,!0),this.xhr.send(t)}function n(t){if(0!==this.xhr.status){{this.getReadyStateString(this.xhr.readyState)}if(this.xhr.readyState==this.xhr.UNSENT);else if(this.xhr.readyState==this.xhr.OPENED);else if(this.xhr.readyState==this.xhr.HEADERS_RECEIVED);else if(this.xhr.readyState==this.xhr.LOADING);else if(this.xhr.readyState==this.xhr.DONE){var e={};e.status=this.xhr.status,e.responseText=this.xhr.responseText,this.completeRequest(e)}}}function i(t){this.complete(t),this.remove()}function o(t){}function r(){this.loaderURL="",this.xhr=null}function s(t){var e;return t==this.xhr.UNSENT?e="UNSENT":t==this.xhr.OPENED?e="OPENED":t==this.xhr.HEADERS_RECEIVED?e="HEADERS_RECEIVED":t==this.xhr.LOADING?e="LOADING":t==this.xhr.DONE&&(e="DONE"),e}return ALGO.Loader=function(t){var e=this;this.loaderURL=t,this.xhr=new XMLHttpRequest,this.xhr.onreadystatechange=function(t){e.readyStateChange(t)}},ALGO.Loader.prototype={constructor:ALGO.Loader,loaderURL:"",xhr:null,get:t,post:e,complete:o,remove:r,readyStateChange:n,getReadyStateString:s,completeRequest:i},ALGO.Loader}(),ALGO.ShapeCtrl={createID:function(t,e){for(var n="abcdefghijklmnopqrstuvwxyz0123456789",i=e?e:12,o="",r=0;i>r;r++){var s=n.length,a=Math.floor(Math.random()*s);o+=n.charAt(a)}return t.indexOf(o)>-1&&arguments.callee(t,e),o}},ALGO.Shape=function(){"use strict";function t(){this.geometry=[],this.vertexPosition=[],this.vertexColors=[],this.vertexLineColors=[],this.index=[],this.m=new ALGO.Matrix3,this.matrix=this.m.identity(this.m.create()),this.matrixScale=this.m.identity(this.m.create()),this.matrixRotate=this.m.identity(this.m.create()),this.matrixTranslate=this.m.identity(this.m.create())}function e(){this.setGeometry(),this.setVertexPosition(),this.setVertexColor(this.color,this.vertexColors),this.setVertexAlpha(this.alpha,this.vertexColors),this.setVertexColor(this.lineColor,this.vertexLineColors),this.setVertexAlpha(this.lineAlpha,this.vertexLineColors),this.setIndex(),this.setTextureCoord(),this.setScale(this.scale),this.setRotate(this.rotate),this.setTranslate(this.x,this.y)}function n(t){this.id||(this.id=ALGO.ShapeCtrl.createID(t.displayObjects,8)),t.displayObjects.push(this.id),t.children.push(this)}function i(t){var e=t.displayObjects.indexOf(this.id);e>-1&&(t.displayObjects.splice(e,1),t.children.splice(e,1))}function o(){this.geometry=[],this.vertexPosition=[],this.vertexColors=[],this.vertexLineColors=[],this.setVertexPosition(),this.setVertexColor(this.color,this.vertexColors),this.setVertexAlpha(this.alpha,this.vertexColors),this.setVertexColor(this.lineColor,this.vertexLineColors),this.setVertexAlpha(this.lineAlpha,this.vertexLineColors)}function r(){}function s(){var t=this.geometry;t[0]={x:0,y:-1},t[1]={x:-.87,y:.5},t[2]={x:.87,y:.5}}function a(){for(var t=this.vertexPosition,e=this.geometry.length,n=0;e>n;n++){var i=2*n;t[i]=this.geometry[n].x,t[i+1]=this.geometry[n].y}}function u(t,e){for(var n=e,i=this.geometry.length,o=ALGO.ColorUtil.hexToRgbNormalize(t),r=0;i>r;r++){var s=4*r;n[s]=o.r,n[s+1]=o.g,n[s+2]=o.b}}function h(t,e){for(var n=e,i=this.geometry.length,o=0;i>o;o++){var r=4*o;n[r+3]=t}}function l(){var t=[0,1,2];this.index=t}function p(){var t=[0,0,1,0,0,1,1,1];this.textureCoord=t}function c(){this.setVertexPosition(),this.setVertexColor(this.color,this.vertexColors),this.setVertexAlpha(this.alpha,this.vertexColors),this.setVertexColor(this.lineColor,this.vertexLineColors),this.setVertexAlpha(this.lineAlpha,this.vertexLineColors),this.setIndex(),this.setTextureCoord()}function d(t){if(this.m){var e=this.radius*t,n=this.radius*t;this.m.scale(this.matrix,[e,n,0],this.matrixScale)}}function f(t){if(this.m){var e=t*Math.PI/180;this.m.rotate(this.matrix,e,this.matrixRotate)}}function g(t,e){this.m&&this.m.translate(this.matrix,[t,e,0],this.matrixTranslate)}function y(){var t=null;return this.m&&(t=this.m.identity(this.m.create()),this.m.multiply(t,this.matrixScale,t),this.m.multiply(t,this.matrixRotate,t),this.m.multiply(t,this.matrixTranslate,t)),t}return ALGO.Shape=function(t,e,n){this.x=t,this.y=e,this.angles=3,this.radius=n,this.angles_=3,this.radius_=n,this.init(),this.setup()},ALGO.Shape.prototype={constructor:ALGO.Shape,name:"",type:"shape",id:null,x:0,y:0,angles:void 0,radius:null,alpha:1,visible:!0,color:16777215,scale:1,rotate:0,line:!1,lineColor:0,lineAlpha:1,lineWidth:1,fill:!0,m:void 0,matrix:void 0,matrixScale:void 0,matrixRotate:void 0,matrixTranslate:void 0,parent:void 0,children:[],geometry:[],vertexPosition:[],vertexColors:[],vertexLineColors:[],needsUpdate:!1,geometry:[],index:[],textureCoord:[],x_:0,y_:0,scale_:1,rotate_:0,radius_:null,color_:0,alpha_:1,angle_:void 0,needsUpdate_:!1,lineColor_:0,lineAlpha_:1,init:t,setup:e,add:n,remove:i,clone:r,clear:o,setGeometry:s,setVertexPosition:a,setVertexColor:u,setVertexAlpha:h,setIndex:l,setTextureCoord:p,vertexUpdate:c,setScale:d,setRotate:f,setTranslate:g,getMatrix:y},ALGO.Shape}(),ALGO.Shape.prototype.__defineGetter__("x",function(){return this.x_}),ALGO.Shape.prototype.__defineSetter__("x",function(t){this.x_=t,this.setTranslate(this.x,this.y)}),ALGO.Shape.prototype.__defineGetter__("y",function(){return this.y_}),ALGO.Shape.prototype.__defineSetter__("y",function(t){this.y_=t,this.setTranslate(this.x,this.y)}),ALGO.Shape.prototype.__defineGetter__("scale",function(){return this.scale_}),ALGO.Shape.prototype.__defineSetter__("scale",function(t){this.setScale(t),this.scale_=t}),ALGO.Shape.prototype.__defineGetter__("rotate",function(){return this.rotate_}),ALGO.Shape.prototype.__defineSetter__("rotate",function(t){this.setRotate(t),this.rotate_=t}),ALGO.Shape.prototype.__defineGetter__("radius",function(){return this.radius_}),ALGO.Shape.prototype.__defineSetter__("radius",function(t){this.setScale(this.scale),this.radius_=t}),ALGO.Shape.prototype.__defineGetter__("color",function(){return this.color_}),ALGO.Shape.prototype.__defineSetter__("color",function(t){this.setVertexColor(t,this.vertexColors),this.color_=t}),ALGO.Shape.prototype.__defineGetter__("alpha",function(){return this.alpha_}),ALGO.Shape.prototype.__defineSetter__("alpha",function(t){this.setVertexAlpha(t,this.vertexColors),this.alpha_=t}),ALGO.Shape.prototype.__defineGetter__("lineColor",function(){return this.lineColor_}),ALGO.Shape.prototype.__defineSetter__("lineColor",function(t){this.setVertexColor(t,this.vertexLineColors),this.lineColor_=t}),ALGO.Shape.prototype.__defineGetter__("lineAlpha",function(){return this.lineAlpha_}),ALGO.Shape.prototype.__defineSetter__("lineAlpha",function(t){this.setVertexAlpha(t,this.vertexLineColors),this.lineAlpha_=t}),ALGO.Shape.prototype.__defineGetter__("angle",function(){return this.angle_}),ALGO.Shape.prototype.__defineSetter__("angle",function(t){this.angle_=t}),ALGO.Shape.prototype.__defineGetter__("needsUpdate",function(){return this.needsUpdate_}),ALGO.Shape.prototype.__defineSetter__("needsUpdate",function(t){this.needsUpdate_=t}),ALGO.Polygon=function(t,e,n,i){"use strict";this.x=t,this.y=e,this.angles=n,this.radius=i,this.angles_=n,this.radius_=i,this.type="polygon",this.init(),this.setup()},ALGO.Polygon.prototype=Object.create(ALGO.Shape.prototype),ALGO.Polygon.prototype.constructor=ALGO.Polygon,ALGO.Polygon.prototype.setGeometry=function(){for(var t=0;t<this.angles;t++)this.geometry[t]={},this.geometry[t].x=Math.cos(2*t*Math.PI/this.angles-Math.PI/2),this.geometry[t].y=Math.sin(2*t*Math.PI/this.angles-Math.PI/2)},ALGO.Polygon.prototype.setIndex=function(){for(i=1;i<this.angles-1;i++)this.index.push(0),this.index.push(i),this.index.push(i+1)},ALGO.Polygon.prototype.setTextureCoord=function(){this.textureCoord=[0,0];for(var t=0,e=0;e<this.angles;e++){switch(t){case 0:this.textureCoord.push(1),this.textureCoord.push(0);break;case 1:this.textureCoord.push(0),this.textureCoord.push(1);break;case 2:this.textureCoord.push(1),this.textureCoord.push(1)}t++,t>2&&(t=0)}},ALGO.Circle=function(t,e,n){"use strict";this.x=t,this.y=e,this.angles=ALGO.circleResolution,this.radius=n,this.angles_=ALGO.circleResolution,this.radius_=n,this.type="circle",this.init(),this.setup()},ALGO.Circle.prototype=Object.create(ALGO.Polygon.prototype),ALGO.Circle.prototype.constructor=ALGO.Circle,ALGO.Rectangle=function(t,e,n,i){"use strict";this.x=t,this.y=e,this.width=n,this.height=i,this.width_=n,this.height_=i,this.type="rectangle",this.init(),this.setup()},ALGO.Rectangle.prototype=Object.create(ALGO.Shape.prototype),ALGO.Rectangle.prototype.constructor=ALGO.Rectangle,ALGO.Rectangle.prototype.width=0,ALGO.Rectangle.prototype.height=0,ALGO.Rectangle.prototype.width_=0,ALGO.Rectangle.prototype.height_=0,ALGO.Rectangle.prototype.setScale=function(t){if(this.m){var e=.5*this.width*t,n=.5*this.height*t;this.m.scale(this.matrix,[e,n,0],this.matrixScale)}},ALGO.Rectangle.prototype.setGeometry=function(){var t=this.geometry=[];t[0]=[],t[0].x=-1,t[0].y=1,t[1]=[],t[1].x=1,t[1].y=1,t[2]=[],t[2].x=-1,t[2].y=-1,t[3]=[],t[3].x=1,t[3].y=-1},ALGO.Rectangle.prototype.setIndex=function(){var t=[0,1,2,3,2,1];this.index=t},ALGO.Rectangle.prototype.__defineGetter__("width",function(){return this.width_}),ALGO.Rectangle.prototype.__defineSetter__("width",function(t){this.width_=t,this.setScale(this.scale)}),ALGO.Rectangle.prototype.__defineGetter__("height",function(){return this.height_}),ALGO.Rectangle.prototype.__defineSetter__("height",function(t){this.height_=t,this.setScale(this.scale)}),ALGO.Path=function(t,e){"use strict";this.start=t,this.end=e,this.type="path",this.holes=[],this.triangles=null,this.init(),this.setup(),this.initLine()},ALGO.Path.prototype=Object.create(ALGO.Shape.prototype),ALGO.Path.prototype.constructor=ALGO.Path,ALGO.Path.prototype.closed=!1,ALGO.Path.prototype.holes=[],ALGO.Path.prototype.triangles=null,ALGO.Path.prototype.setGeometry=function(){},ALGO.Path.prototype.geometryToPoly=function(t,e){for(var n,i,o=[],r=t.length,s=e,a=0;r>a;a++){var u=t[a].x,h=t[a].y;if(n!==u||i!==h){var l={x:u,y:h,id:s};o.push(l),n=u,i=h,s++}}return o},ALGO.Path.prototype.setIndex=function(){var t=(this.index=[],this.geometry.length);if(t>2){var e=this.geometryToPoly(this.geometry,0),n=new poly2tri.SweepContext(e,{cloneArrays:!0}),i=this.holes.length,o=e.length;for(l=0;i>l;l++){var r=this.holes[l],s=this.geometryToPoly(r,o);e=e.concat(s),o+=s.length,n.addHole(s)}this.geometry=e;var a=n.triangulate(),u=a.getTriangles()||[];this.triangles=u;for(var h=[],l=0;l<u.length;l++){var p=u[l],c=p.getPoint(0),d=p.getPoint(1),f=p.getPoint(2);h.push(c.id),h.push(d.id),h.push(f.id)}this.index=h,this.vertexPosition=[],this.setVertexPosition(),this.setVertexColor(this.color,this.vertexColors),this.setVertexAlpha(this.alpha,this.vertexColors),this.setVertexColor(this.lineColor,this.vertexLineColors),this.setVertexAlpha(this.lineAlpha,this.vertexLineColors),this.setTextureCoord()}},ALGO.Path.prototype.setTextureCoord=function(){var t=this.geometry.length;this.textureCoord=[0,0];for(var e=0,n=0;t>n;n++){switch(e){case 0:this.textureCoord.push(1),this.textureCoord.push(0);break;case 1:this.textureCoord.push(0),this.textureCoord.push(1);break;case 2:this.textureCoord.push(1),this.textureCoord.push(1)}e++,e>2&&(e=0)}},ALGO.Path.prototype.setScale=function(t){if(this.m){var e=t,n=t;this.m.scale(this.matrix,[e,n,0],this.matrixScale)}},ALGO.Path.prototype.initLine=function(){var t=this.start,e=this.end;t&&this.moveTo(t.x,t.y),e&&this.lineTo(e.x,e.y)},ALGO.Path.prototype.moveTo=function(t,e){var n={x:t,y:e};this.geometry.push(n),this.vertexUpdate()},ALGO.Path.prototype.lineTo=function(t,e){var n={x:t,y:e};this.geometry.push(n),this.vertexUpdate()},ALGO.Path.prototype.close=function(){this.closed=!0},ALGO.Particle=function(t,e){"use strict";this.x=t,this.y=e,this.angles=10,this.angles_=10,this.radius=100,this.radius_=100,this.type="particle",this.init(),this.setup()},ALGO.Particle.prototype=Object.create(ALGO.Shape.prototype),ALGO.Particle.prototype.constructor=ALGO.Particle,ALGO.Particle.prototype.pointsize=1,ALGO.Particle.prototype.setGeometry=function(t){t&&(this.geometry=t,this.vertexUpdate())},ALGO.Particle.prototype.setIndex=function(){},ALGO.Particle.prototype.setTextureCoord=function(){var t=this.geometry.length;this.textureCoord=[0,0];for(var e=0,n=0;t>n;n++){switch(e){case 0:this.textureCoord.push(1),this.textureCoord.push(0);break;case 1:this.textureCoord.push(0),this.textureCoord.push(1);break;case 2:this.textureCoord.push(1),this.textureCoord.push(1)}e++,e>2&&(e=0)}},ALGO.Particle.prototype.setScale=function(t){if(this.m){var e=t,n=t;this.m.scale(this.matrix,[e,n,0],this.matrixScale)}},ALGO.Image=function(t,e,n,i,o){"use strict";this.path=o,this.x=t,this.y=e,this.width=n,this.height=i,this.mipmap=0;var r=this;this.width_=n,this.height_=i,this.mipmap_=this.mipmap,this.color=16777215,this.type="image",this.isLoaded=!1,this.isAttached=!1,this.texture=null,this.path&&(this.image=new Image,this.image.src=this.path,this.loader=new ALGO.Loader(this.path),this.loader.complete=function(t){r.complete(t)},this.loader.get()),this.init(),this.setup()},ALGO.Image.prototype=Object.create(ALGO.Rectangle.prototype),ALGO.Image.prototype.constructor=ALGO.Image,ALGO.Image.prototype.isLoaded=!1,ALGO.Image.prototype.texture=null,ALGO.Image.prototype.mipmap=0,ALGO.Image.prototype.mipmap_=0,ALGO.Image.prototype.complete=function(){this.isLoaded=!0,delete this.loader},ALGO.Image.prototype.getTexture=function(){return this.texture},ALGO.Image.prototype.setTexture=function(t){this.texture=t},ALGO.Image.prototype.setLoaded=function(t){this.isLoaded=t},ALGO.Image.prototype.setScale=function(t){if(this.m){var e=.5*this.width*t,n=.5*this.height*-t;this.m.scale(this.matrix,[e,n,0],this.matrixScale)}},ALGO.Image.prototype.__defineGetter__("mipmap",function(){return this.mipmap_}),ALGO.Image.prototype.__defineSetter__("mipmap",function(t){this.mipmap_=t}),ALGO.SVG=function(){"use strict";function t(){}function e(t){var e=new ALGO.Loader(t);e.get(),e.complete=function(t){var e=t.status,i=t.responseText;if(e>=200&&300>e){var o=r(i),s=n(o);if(s&&c.always){var a={verticles:s};c.always(a)}}}}function n(t){for(var e=t.childNodes,n=0;n<e.length;n++){var o=e[n];if(1==o.nodeType){var r=i(o);if(r&&(d.push(r),c.complete)){var s={vertex:r};c.complete(s)}}}return d}function i(t){var e,i=t.nodeName.toLowerCase();return"svg"===i?n(t):"g"===i?n(t):"path"===i&&(e=o(t)),e}function o(t){function e(t,e){var n=+i[t];return h&&(n+=l[e]),n}function n(t){var n=e(t,"x"),i=e(t+1,"y"),o={x:n,y:i};return o}for(var i,o,r,a=t.getAttribute("d"),u=a.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/gi),h=!1,l={x:0,y:0},p=[],c=[],d=0,f=u&&u.length;f>d;d++){var g=u[d],y=g[0],x=y.toLowerCase(),i=g.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),_=i&&i.length;switch(h=y===x,"z"===o&&(/[mz]/.test(x)||ALGO.log("TEST TRUE")),x){case"m":case"l":for(var v=0;_>v;v+=2)l=n(v),ALGO.log("setx: "+l.x+", sety: "+l.y),c.push({x:l.x,y:l.y});break;case"h":case"v":for(var m="h"===x?"x":"y",v=0;_>v;v++)l[m]=e(v,m),ALGO.log("setx: "+l.x+", sety: "+l.y),c.push({x:l.x,y:l.y});break;case"c":for(var v=0;_>v;v+=6){var A=n(v),L=r=n(v+2),C=l;l=n(v+4);for(var w=s(C.x,C.y,A.x,A.y,L.x,L.y,l.x,l.y),O=1;O<w.length-1;O++)ALGO.log("setx: "+w[O].x+", sety: "+w[O].y),c.push(w[O])}break;case"s":for(var v=0;_>v;v+=4){var L=l;if(/[cs]/.test(o)){var b=2*l.x-r.x,G=2*l.y-r.y;L={x:b,y:G}}var A=r=n(v),C=l;l=n(v+2);for(var w=s(C.x,C.y,L.x,L.y,A.x,A.y,l.x,l.y),O=1;O<w.length-1;O++)ALGO.log("setx: "+w[O].x+", sety: "+w[O].y),c.push(w[O]);o=x}break;case"q":for(var v=0;_>v;v+=4)r=n(v),l=n(v+2),ALGO.log("setx: "+l.x+", sety: "+l.y),c.push({x:l.x,y:l.y});break;case"t":for(var v=0;_>v;v+=2)r=/[qt]/.test(o)?l.multiply(2).subtract(r):l,l=n(v),o=x;break;case"a":for(var v=0;_>v;v+=7)l=n(v+5),ALGO.log("setx: "+l.x+", sety: "+l.y),c.push({x:l.x,y:l.y});break;case"z":c.splice(c.length-1,1),p.push(c),ALGO.log("z end."),c=[]}o=x}return p}function r(t){if("undefined"!=typeof Windows&&"undefined"!=typeof Windows.Data&&"undefined"!=typeof Windows.Data.Xml){var e=new Windows.Data.Xml.Dom.XmlDocument,n=new Windows.Data.Xml.Dom.XmlLoadSettings;return n.prohibitDtd=!1,e.loadXml(t,n),e}if(window.DOMParser){var i=new DOMParser;return i.parseFromString(t,"text/xml")}t=t.replace(/<!DOCTYPE svg[^>]*>/,"");var e=new ActiveXObject("Microsoft.XMLDOM");return e.async="false",e.loadXML(t),e}function s(t,e,n,i,o,r,s,u){for(var h=[],l=0;1.01>=l;l+=.05)h.push(a({x:t,y:e},{x:n,y:i},{x:o,y:r},{x:s,y:u},l));return h}function a(t,e,n,i,o){var r={x:0,y:0},s=(1-o)*(1-o)*(1-o);return r.x+=s*t.x,r.y+=s*t.y,s=3*o*(1-o)*(1-o),r.x+=s*e.x,r.y+=s*e.y,s=3*o*o*(1-o),r.x+=s*n.x,r.y+=s*n.y,s=o*o*o,r.x+=s*i.x,r.y+=s*i.y,r}function u(){}function h(){}function l(t,e){this[t]=e}function p(t,e){c[t]=null}var c,d=[];return ALGO.SVG=function(){t(),c=this},ALGO.SVG.prototype={constructor:ALGO.SVG,load:e,bind:l,unbind:p,complete:u,always:h},ALGO.SVG}(),ALGO.WebGLRenderer=function(t){"use strict";function e(e){var n=!1;y=e,a(y),y.backgroundAuto||(n=!0),t.log("that.backgroundAuto: "+y.backgroundAuto);var r={preserveDrawingBuffer:n};x=w.getContext("webgl",r)||w.getContext("experimental-webgl",r);var s=p("vertex"),u=p("fragment");_=c(s,u),o(),C={},C.position=x.getUniformLocation(_,"position2d"),C.matrix=x.getUniformLocation(_,"matrix2d"),C.color=x.getUniformLocation(_,"color"),C.texture=x.getUniformLocation(_,"texture"),C.point_size=x.getUniformLocation(_,"point_size"),C.isTexture=x.getUniformLocation(_,"isTexture"),v={},v.position=x.getAttribLocation(_,"position2d"),v.color=x.getAttribLocation(_,"color"),v.texture_coord=x.getAttribLocation(_,"texture_coord"),m={},m.position=2,m.color=4,m.texture_coord=2,i()}function n(t,e){return[2/t,0,0,0,-2/e,0,-1,1,1]}function i(){for(var e=new t.Matrix3,i=n(A,L),o=0;o<E.length;o++){var r=E[o],s=r.needsUpdate,a=r.fill,u=r.line,h=r.vertexPosition,l=r.vertexColors,p=r.textureCoord,c=null;x.uniform1f(C.isTexture,0);var y=r.vertexLineColors||r.vertexColors,_=r.index,w=r.getMatrix(),O=e.multiply(w,i,[]),b=r.lineWidth,G=r.pointsize;if(a){if("image"==r.type&&r.isLoaded&&(c=r.getTexture(),x.uniform1f(C.isTexture,1),c?x.texImage2D(x.TEXTURE_2D,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,r.image):(c=x.createTexture(x.TEXTURE_2D),x.activeTexture(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,c),x.texImage2D(x.TEXTURE_2D,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,r.image),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,x.LINEAR),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,x.LINEAR),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),r.setTexture(c))),!S[o]||s){var T=[];T.position=d(h),T.color=d(l),T.texture_coord=d(p),"image"==r.type,S[o]=T}if(g(S[o],v,m),"particle"!==r.type){if(!P[o]||s){var N=f(_);D[o]=_,P[o]=N}x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,P[o])}x.uniformMatrix3fv(C.matrix,!1,O),x.bindTexture(x.TEXTURE_2D,c),x.uniform1i(C.texture,0),"path"==r.type?r.closed?x.drawElements(x.TRIANGLES,D[o].length,x.UNSIGNED_SHORT,0):x.drawElements(x.TRIANGLES,D[o].length,x.UNSIGNED_SHORT,0):"particle"==r.type?(x.uniform1f(C.point_size,G),x.drawArrays(x.POINTS,0,h.length/2)):x.drawElements(x.TRIANGLES,D[o].length,x.UNSIGNED_SHORT,0)}if(u){if(!R[o]||s){var T=[];T.position=d(h),T.color=d(y),R[o]=T}g(R[o],v,m),x.uniformMatrix3fv(C.matrix,!1,O),x.lineWidth(b),"path"==r.type?r.closed?x.drawArrays(x.LINE_LOOP,0,h.length/2):x.drawArrays(x.LINE_STRIP,0,h.length/2):x.drawArrays(x.LINE_LOOP,0,h.length/2)}s&&(r.needsUpdate=!1)}x.flush()}function o(){A=w.width,L=w.height;var t=x.getUniformLocation(_,"u_resolution");x.uniform2f(t,w.width,w.height),x.viewport(0,0,A,L)}function r(){return x}function s(){a(y),u(),h(),l(),i()}function a(t){w=t.canvas,O=t.background,b=t.backgroundAlpha,G=t.backgroundAuto,E=t.children,T=t.displayObjects}function u(){x.clearDepth(N)}function h(){if(G){var e=t.ColorUtil.hexToRgbNormalize(O);x.clearColor(e.r,e.g,e.b,b),x.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT)}}function l(){var e=y.blendMode;e>0&&x.enable(x.BLEND),e==t.BLEND_ADD?x.blendFunc(x.SRC_ALPHA,x.ONE):e==t.BLEND_MULTIPLY?x.blendFunc(x.DST_COLOR,x.ZERO):e==t.BLEND_SCREEN?x.blendFunc(x.ONE_MINUS_DST_COLOR,x.ONE):e==t.BLEND_ALPHA&&x.blendFunc(x.SRC_ALPHA,x.ONE_MINUS_SRC_ALPHA)}function p(t){var e,n="";return"vertex"==t?(n="\r\n      attribute vec2 position2d;\r\n      uniform mat3 matrix2d;\r\n      uniform vec2 u_resolution;\r\n      attribute vec4 color;\r\n      varying vec4 v_color; \r\n      attribute vec2 texture_coord;\r\n      varying vec2 v_texture_coord;\r\n      uniform float point_size;\r\n      varying float vIsTexture;\r\n      uniform float isTexture;\r\n      \r\n      void main(void){\r\n        if(isTexture>0.5){\r\n          v_texture_coord = texture_coord;\r\n          vIsTexture = isTexture;\r\n        }\r\n        v_color = color;\r\n        gl_PointSize = point_size;\r\n        \r\n        gl_Position = vec4((matrix2d * vec3(position2d, 1)).xy, 0, 1);\r\n      }",e=x.createShader(x.VERTEX_SHADER)):"fragment"==t&&(n="\r\n      precision mediump float;\r\n      varying vec4 v_color;\r\n      uniform sampler2D texture;\r\n      varying vec2 v_texture_coord;\r\n      varying float vIsTexture;\r\n      \r\n      void main(void){\r\n        if(vIsTexture > 0.5){\r\n          vec4 smp_color = texture2D(texture, v_texture_coord);\r\n          gl_FragColor  = v_color * smp_color;\r\n        }\r\n        else{\r\n          gl_FragColor  = v_color;\r\n        }\r\n      }",e=x.createShader(x.FRAGMENT_SHADER)),x.shaderSource(e,n),x.compileShader(e),x.getShaderParameter(e,x.COMPILE_STATUS)?e:void alert(x.getShaderInfoLog(e))}function c(t,e){var n=x.createProgram();return x.attachShader(n,t),x.attachShader(n,e),x.linkProgram(n),x.getProgramParameter(n,x.LINK_STATUS)?(x.useProgram(n),n):void alert(x.getProgramInfoLog(n))}function d(t){var e=x.createBuffer();return x.bindBuffer(x.ARRAY_BUFFER,e),x.bufferData(x.ARRAY_BUFFER,new Float32Array(t),x.STATIC_DRAW),x.bindBuffer(x.ARRAY_BUFFER,null),e}function f(t){var e=x.createBuffer();return x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,e),x.bufferData(x.ELEMENT_ARRAY_BUFFER,new Int16Array(t),x.STATIC_DRAW),x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,null),e}function g(t,e,n){for(var i in t)x.bindBuffer(x.ARRAY_BUFFER,t[i]),x.enableVertexAttribArray(e[i]),x.vertexAttribPointer(e[i],n[i],x.FLOAT,!1,0,0)}var y,x,_,v,m,A,L,C,w,O,b,G,E,T,S=[],R=[],P=[],D=[],N=0;return t.WebGLRenderer=function(t){e(t)},t.WebGLRenderer.prototype={constructor:t.WebGLRenderer,init:e,update:s,resize:o,getContext:r},t.WebGLRenderer}(ALGO),ALGO.Sound=function(t){"use strict";function e(){var e=this,n=t.Util.getBrowser(),i=t.Util.isSmartDevice(),o=null;"chrome"==n||"firefox"==n||"opera"==n?o=this.ogg:"safari"==n&&(o=this.mp3);var r=localStorage;this.isInitplay=Number(r.stopped)?!1:!0,i&&(this.isInitplay=!1);var s=new AudioContext,a=s.createAnalyser();a.connect(s.destination);var u=s.createBiquadFilter();u.connect(s.destination),u.type="allpass",u.frequency.value=220,s.createGain=s.createGain||s.createGainNode;var h=s.createGain();h.connect(a);var l=new Uint8Array(a.frequencyBinCount),p=new Uint8Array(a.frequencyBinCount),c=new BufferLoader(s,[o],function(t){
e.finishedLoading(t)});c.load(),this.context=s,this.analyser=a,this.gainNode=h,this.filter=u,this.timeDomainData=l,this.frequencyData=p,this.bufferLoader=c}function n(){}function o(t){this.buffers=t,this.isInitplay&&this.play(0)}function r(){this.updateFFT(),this.updateNotes()}function s(){this.analyser.getByteFrequencyData(this.frequencyData),this.timeDomainTotal=0,this.timeDomainValues=[],this.frequencyTotal=0,this.frequencyValues=[];var t=this.timeDomainData.length;for(i=0;i<t;i++)this.frequencyValues[i]=parseInt(this.frequencyData[i])/255,this.frequencyTotal+=this.frequencyValues[i];this.frequencyTotal=this.frequencyTotal/t}function a(){var t=1e3*(this.context.currentTime-this.currentTimeBefore);this.noteCount+=t,this.noteHalfCount+=t,this.noteCount>=this.noteTime&&(this.noteCount=0,this.noteEvent(this.context.currentTime)),this.noteHalfCount>=this.noteHalfTime&&(this.noteHalfCount=0,this.halfNoteEvent(this.context.currentTime)),this.currentTimeBefore=this.context.currentTime}function u(){this.startTime=this.context.currentTime,this.source=this.context.createBufferSource(),this.source.buffer=this.buffers[0],this.source.loop=!0,this.source.connect(this.filter),this.source.connect(this.gainNode),t.log(this.source),this.gainNode.gain.value=this.volume,this.source.start(0),this.isPlay=!0;try{localStorage.stopped=0}catch(e){}}function h(){this.source.stop(0),this.isPlay=!1;try{localStorage.stopped=1}catch(t){}}function l(){var t=this.context.currentTime-this.startTime;return null==this.startTime&&(t=0),t}function p(){return this.noteTime}function c(){return this.isPlay}function d(){return this.timeDomainValues}function f(){return this.timeDomainTotal}function g(){return this.frequencyValues}function y(){return this.frequencyTotal}function x(t,e){for(var n=Math.floor(t.length/e),i=[],o=0;n>o;o++){var r=n*o,s=n*(o+1);i[o]=0;for(var a=r;s>a;a++)t[a]&&(i[o]+=t[a])}return i}return t.Sound=function(t,e,n){this.mp3=t,this.ogg=e,this.bpm=n,this.noteTime=6e4/this.bpm,this.noteHalfTime=.5*this.noteTime,window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext?this.startLoading():this.startNotAvarableMode()},t.Sound.prototype={constructor:t.Sound,bpm:0,noteTime:0,noteHalfTime:0,noteCount:0,noteHalfCount:0,currentTimeBefore:0,mp3:"",ogg:"",context:null,analyser:null,gainNode:null,filter:null,bufferLoader:null,source:null,buffers:null,pauseTime:0,startTime:null,isPlay:!1,volume:1,isInitplay:0,timeDomainData:null,timeDomainTotal:0,timeDomainValues:[],frequencyData:null,frequencyTotal:0,frequencyValues:[],noteEvent:function(){},halfNoteEvent:function(){},play:u,stop:h,update:r,getCurrentTime:l,getNoteTime:p,getPlay:c,getTimeDomainValues:d,getTimeDomainTotal:f,getFrequencyValues:g,getFrequencyTotal:y,getSplitValues:x,startLoading:e,startNotAvarableMode:n,finishedLoading:o,updateFFT:s,updateNotes:a},t.Sound}(ALGO),ALGO.RTC=function(t){"use strict";function e(t){this.mediaStream=t,this.audioContext=new AudioContext,this.audioSource=this.audioContext.createMediaStreamSource(this.mediaStream),this.setupAudioAnalazer(),this.setupVideoRecorder()}function n(){this.audioFilter=this.audioContext.createBiquadFilter(),this.audioFilter.type="allpass",this.audioFilter.frequency.value=220,this.audioAnalyser=this.audioContext.createAnalyser(),this.audioSource.connect(this.audioFilter),this.audioFilter.connect(this.audioAnalyser),this.timeDomainData=new Uint8Array(this.audioAnalyser.frequencyBinCount),this.frequencyData=new Uint8Array(this.audioAnalyser.frequencyBinCount)}function i(){var e=window.URL||window.webkitURL;this.videoSource=e.createObjectURL(this.mediaStream),t.log(this.mediaStream),t.log(this.videoSource),this.videoElement=document.createElement("video"),this.videoElement.src=this.videoSource,this.videoElement.id="video",this.videoElement.muted=!0,this.videoElement.volume=0;var n=this;this.videoElement.addEventListener("canplay",function(t){n.videoCanPlay(t)},!0)}function o(t){this.videoElement.removeEventListener("canplay",null,!0),this.videoElement.play(),this.isPlaying=!0}function r(){this.enableAudio&&this.updateAudio(),this.enableVideo&&this.updateVideo()}function s(){this.audioAnalyser&&this.updateAudioAnalazer()}function a(){this.audioAnalyser.getByteTimeDomainData(this.timeDomainData),this.audioAnalyser.getByteFrequencyData(this.frequencyData),this.timeDomainTotal=0,this.timeDomainValues=[],this.frequencyTotal=0,this.frequencyValues=[];for(var t=this.frequencyData.length,e=0;t>e;e++)this.timeDomainValues[e]=parseInt(this.timeDomainData[e])/255,this.timeDomainTotal+=this.timeDomainValues[e],this.frequencyValues[e]=parseInt(this.frequencyData[e])/255,this.frequencyTotal+=this.frequencyValues[e];this.timeDomainTotal=this.timeDomainTotal/t,this.frequencyTotal=this.frequencyTotal/t}function u(){}function h(t){this.opticalFlow=new FlowCalculator(t)}function l(t,e,n){var i;return this.newImage=t,this.oldImage&&this.newImage&&(i=this.opticalFlow.calculate(this.oldImage,this.newImage,e,n)),this.oldImage=this.newImage,i}function p(){return this.timeDomainValues}function c(){return this.timeDomainTotal}function d(){return this.frequencyValues}function f(){return this.frequencyTotal}function g(t){this.enableAudio=t}function y(t){this.enableVideo=t}return t.RTC=function(e,n){var i=this;this.enableAudio=e,this.enableVideo=n,this.isPlaying=!1,navigator.getMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext,window.Recorder=window.StereoRecorder||window.MediaStreamRecorder;try{navigator.getMedia({video:!0,audio:!0},function(t){i.success(t)},function(t){i.error(t)})}catch(o){t.log("This browser is not support getUserMedia API. "+o)}},t.RTC.prototype={constructor:t.RTC,enableAudio:!1,enableVideo:!1,videoElement:null,frequencyValues:[],frequencyTotal:0,timeDomainValues:[],timeDomainTotal:0,mediaStream:null,audioContext:null,audioSource:null,audioFilter:null,audioAnalyser:null,timeDomainData:null,frequencyData:null,videoSource:null,isPlaying:!1,update:r,getTimeDomainValues:p,getTimeDomainTotal:c,getFrequencyValues:d,getFrequencyTotal:f,setEnableAudio:g,setEnableVideo:y,setupOpticalFlow:h,updateOpticalFlow:l,success:e,setupAudioAnalazer:n,setupVideoRecorder:i,videoCanPlay:o,updateAudio:s,updateVideo:u,updateAudioAnalazer:a},t.RTC}(ALGO),ALGO.log=function(){window.console&&window.console.log&&ALGO.debug&&window.console.log.apply(console,arguments)},ALGO.warn=function(){window.console&&window.console.log&&ALGO.debug&&window.console.warn.apply(console,arguments)},ALGO.error=function(){window.console&&window.console.log&&ALGO.debug&&window.console.error.apply(console,arguments)},ALGO.PointUtil={normalize:function(t,e){var n=Math.sqrt(t.x*t.x+t.y*t.y);0!=n&&(t.x=e*t.x/n,t.y=e*t.y/n)},normalize3:function(t,e){var n=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z);return 0!=n&&(t.x=e*t.x/n,t.y=e*t.y/n,t.z=e*t.z/n),t},pointLength3:function(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)},getDistance:function(t,e){var n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)},getSlope:function(t,e){return(e.y-t.y)/(e.x-t.x)},getIntercept:function(t,e,n){var i=t.x+e.x,o=t.y+e.y;return o/2-n*i/2},getMidpoint:function(t,e){var n=[];return n.x=(t.x+e.x)/2,n.y=(t.y+e.y)/2,n},getMidperpendicular:function(t,e){var n=getSlope(t,e);x=checkEQ(n)?1:-1/n;var i=getMidpoint(t,e);return y=checkEQ(n)?0:i.y-x*i.x,{x:x,y:y}},getThroughPoint3:function(t,e,n){var i=getMidperpendicular(t,e),o=getMidperpendicular(t,n),r=[];r.x=(o.y-i.y)/(i.x-o.x),r.y=i.x*r.x+i.y;var s=Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2));return{x:r.x,y:r.y,rad:s}},getHugeTriangle:function(t,e,n){var i=getThroughPoint3(t,e,n),o=i.x-Math.sqrt(3)*i.rad,r=i.y-i.rad,s=i.x+Math.sqrt(3)*i.rad,a=i.y-i.rad,u=i.x,h=i.y+2*i.rad;return[{x:o,y:r},{x:s,y:a},{x:u,y:h}]},checkEQ:function(t){var e=1e-6;return t>=-e&&e>=t}},ALGO.StringUtil={zeroPadding:function(t,e){return(Array(e).join("0")+t).slice(-e)},numComma:function(t){return String(t).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},separate:function(t){return String(t).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")}},ALGO.ObjectUtil={extend:function(t,e){ALGO.ObjectUtil.clone(t);for(key in e){var n=e[key]?e[key]:t[key];t[key]=n}return t},clone:function(t){var e={};for(key in t)e[key]=t[key];return e}},ALGO.ColorUtil={rgbToHex:function(t,e,n){t=Math.floor(t),e=Math.floor(e),n=Math.floor(n);var i=(t<<16)+(e<<8)+n;return"0x"+i.toString(16)},hexToRgb:function(t){t=t.toString(16).replace("#","").replace("0x",""),t="0x"+t;var e={r:t>>16,g:t>>8&255,b:255&t};return e},hexToRgbNormalize:function(t){var e=ALGO.ColorUtil.hexToRgb(t);return e.r=e.r/256,e.g=e.g/256,e.b=e.b/256,e},rgbNormalize:function(t){return t.r=t.r/256,t.g=t.g/256,t.b=t.b/256,t},getRandomColorHex:function(){var t=ALGO.ColorUtil.getRandomColor(0,256),e=ALGO.ColorUtil.getRandomColor(0,256),n=ALGO.ColorUtil.getRandomColor(0,256);return ALGO.ColorUtil.rgbToHex(t,e,n)},getRandomColorRGB:function(){var t=ALGO.ColorUtil.getRandomColor(0,256),e=ALGO.ColorUtil.getRandomColor(0,256),n=ALGO.ColorUtil.getRandomColor(0,256);return{r:t,g:e,b:n}},getRandomColor:function(t,e){return 0>t&&(t=0),e>256&&(e=256),t>e&&(t=e),t>e&&(e=t),Math.floor(Math.random()*e)+t}},ALGO.Util={getPixelsIndex:function(t,e,n){},getBrowserLang:function(){var t=window.navigator.userAgent.toLowerCase();try{return-1!=t.indexOf("chrome")?(navigator.languages[0]||navigator.browserLanguage||navigator.language||navigator.userLanguage).substr(0,2):(navigator.browserLanguage||navigator.language||navigator.userLanguage).substr(0,2)}catch(e){return void 0}},isSmartDevice:function(){var t=navigator.userAgent,e=!1;return t.indexOf("iPhone")>0&&-1==t.indexOf("iPad")||t.indexOf("iPod")>0||t.indexOf("Android")>0&&t.indexOf("Mobile")>0?e="smartphone":(t.indexOf("iPad")>0||t.indexOf("Android")>0)&&(e="tablet"),e},getOS:function(){var t,e=window.navigator.userAgent.toLowerCase();return t=e.match(/win/)?"win":e.match(/mac|ppc/)?"mac":e.match(/linux/)?"linux":"other"},getBrowser:function(){var t=window.navigator.userAgent.toLowerCase(),e=window.navigator.appVersion.toLowerCase(),n="unknown";return-1!=t.indexOf("msie")?n=-1!=e.indexOf("msie 6.")?"ie6":-1!=e.indexOf("msie 7.")?"ie7":-1!=e.indexOf("msie 8.")?"ie8":-1!=e.indexOf("msie 9.")?"ie9":-1!=e.indexOf("msie 10.")?"ie10":"ie":-1!=t.indexOf("trident/7")?n="ie11":-1!=t.indexOf("chrome")?n="chrome":-1!=t.indexOf("safari")?n="safari":-1!=t.indexOf("opera")?n="opera":-1!=t.indexOf("firefox")&&(n="firefox"),n},isSupported:function(t){for(var e=getBrowser(),n=0;n<t.length;n++)if(t[n]==e)return!0;return!1},getQuery:function(){for(var t=window.location.search.substring(1),e=t.split("&"),n={},i=0;i<e.length;i++){var o=e[i].indexOf("=");if(o>0){var r=e[i].substring(0,o),s=e[i].substring(o+1);n[r]=s}}return n}};