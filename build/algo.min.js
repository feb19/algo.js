/*!*
 * algo.js
 *
 * JavaScript Creative Coding Framework
 * http://algojs.com
 *
 * Copyright 2015 hisa hayashi, HYS INC.
 */
var ALGO=function(){"use strict";function t(r){O=this,G=t.ObjectUtil.extend(param,r),e()}function e(){r(),n(),o()}function r(){O.width=param.width,O.height=param.height}function n(){O.render=new t.Render(O),O.render.setFramerate(O.framerate)}function i(){O.canvas=document.getElementById(G.id),O.canvas.width=G.width,O.canvas.height=G.height,O.renderer=new t.WebGLRenderer(O)}function o(){window.onload=function(){i(),O.setup&&O.setup.call(O),a()}}function a(){window.onmouseover=function(){O.mouseover&&O.mouseover.call(O)},window.onmouseout=function(){O.mouseout&&O.mouseout.call(O)},window.onmousedown=function(){O.mousedown&&O.mousedown.call(O)},window.onmouseup=function(){O.mouseup&&O.mouseup.call(O)},window.onmousemove=function(t){if(O.mousemove){var e=t.clientX,r=t.clientY;O.mousemove.call(O,e,r)}},window.onkeydown=function(){O.keydown&&O.keydown.call(O)},window.onkeyup=function(){O.keyup&&O.keyup.call(O)},window.onresize=function(){O.resize&&O.resize.call(O),O.renderer&&O.renderer.resize()},O.render.startRender()}function s(t,e){this[t]=e,O[t]=this[t],O=this}function u(t,e){this[t]=e,O[t]=null}function c(){}function h(){}function l(){}function p(){}function f(){}function d(){}function y(){}function x(){}function g(){}function A(){}function v(){}function m(t,e){O.canvas.width=t,O.canvas.height=e,O.width=t,O.height=e}function L(t){t.add(O)}function _(t){t.remove(O)}var O,G={id:"",width:window.innerWidth,height:window.innerHeight};return t.prototype={constructor:t,setup:c,frame:h,destroy:l,mouseover:p,mouseout:f,mousedown:d,mouseup:y,mousemove:x,keydown:g,keyup:A,resize:v,bind:s,unbind:u,size:m,add:L,remove:_,render:null,renderer:null},t}();ALGO.debug=1,ALGO.BLEND_NONE=0,ALGO.BLEND_ADD=1,ALGO.BLEND_MULTIPLY=2,ALGO.BLEND_SCREEN=3,ALGO.prototype.__defineGetter__("framerate",function(){return this.framerate_}),ALGO.prototype.__defineSetter__("framerate",function(t){this.render&&this.render.setFramerate(t),this.framerate_=t}),ALGO.prototype.__defineGetter__("circleResolution",function(){return this.circleResolution_}),ALGO.prototype.__defineSetter__("circleResolution",function(t){ALGO.circleResolution=t,this.circleResolution_=t}),ALGO.prototype.width=0,ALGO.prototype.height=0,ALGO.prototype.blendMode=ALGO.BLEND_NONE,ALGO.prototype.backgroundAuto=!0,ALGO.prototype.background=6710886,ALGO.prototype.backgroundAlpha=.5,ALGO.prototype.framerate=60,ALGO.prototype.circleResolution=32,ALGO.prototype.canvas=null,ALGO.prototype.displayObjects=[],ALGO.prototype.children=[],ALGO.Render=function(){"use strict";function t(){e(),r()}function e(){}function r(){}function n(t){c=t,h=1e3/c,ALGO.log("setFramerate = "+c)}function i(){return c}function o(){y=!0,h=1e3/c,f=Date.now(),l=f,s()}function a(){y=!1}function s(){if(y&&g(s),p=Date.now(),d=p-f,d>h){f=p-d%h,u.renderer&&u.renderer.update(),u.frame&&u.frame.call(u);{var t=p-l;Math.round(1e3/(t/++x)*100)/100}}}var u,c,h,l,p,f,d,y=!1,x=0,g=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/c)};return ALGO.Render=function(e){u=e,t()},ALGO.Render.prototype={constructor:ALGO.Render,setFramerate:n,getFramerate:i,startRender:o,stopRender:a},ALGO.Render}(),ALGO.Matrix3=function(t){"use strict";function e(){return new Float32Array(16)}function r(t){return t=[1,0,0,0,1,0,0,0,1]}function n(t,e,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],h=t[7],l=t[8],p=e[0],f=e[1],d=e[2],y=e[3],x=e[4],g=e[5],A=e[6],v=e[7],m=e[8];return r[0]=n*p+i*y+o*A,r[1]=n*f+i*x+o*v,r[2]=n*d+i*g+o*m,r[3]=a*p+s*y+u*A,r[4]=a*f+s*x+u*v,r[5]=a*d+s*g+u*m,r[6]=c*p+h*y+l*A,r[7]=c*f+h*x+l*v,r[8]=c*d+h*g+l*m,r}function i(t,e,r){return r[0]=t[0]*e[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4]*e[1],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r}function o(t,e,r){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6]+e[0],r[7]=t[7]+e[1],r[8]=t[8],r}function a(t,e,r){var n=Math.cos(e),i=Math.sin(e);return r[0]=n,r[1]=-i,r[2]=t[2],r[3]=i,r[4]=n,r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r}function s(t,e){return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],e}function u(t,e){return e}return t.Matrix3=function(){},t.Matrix3.prototype={constructor:t.Matrix3,create:e,identity:r,multiply:n,scale:i,translate:o,rotate:a,transpose:s,inverse:u},t.Matrix3}(ALGO),ALGO.Matrix4=function(t){"use strict";function e(){return new Float32Array(16)}function r(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function n(t,e,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],h=t[7],l=t[8],p=t[9],f=t[10],d=t[11],y=t[12],x=t[13],g=t[14],A=t[15],v=e[0],m=e[1],L=e[2],_=e[3],O=e[4],G=e[5],w=e[6],S=e[7],R=e[8],b=e[9],E=e[10],C=e[11],M=e[12],P=e[13],T=e[14],D=e[15];return r[0]=v*n+m*s+L*l+_*y,r[1]=v*i+m*u+L*p+_*x,r[2]=v*o+m*c+L*f+_*g,r[3]=v*a+m*h+L*d+_*A,r[4]=O*n+G*s+w*l+S*y,r[5]=O*i+G*u+w*p+S*x,r[6]=O*o+G*c+w*f+S*g,r[7]=O*a+G*h+w*d+S*A,r[8]=R*n+b*s+E*l+C*y,r[9]=R*i+b*u+E*p+C*x,r[10]=R*o+b*c+E*f+C*g,r[11]=R*a+b*h+E*d+C*A,r[12]=M*n+P*s+T*l+D*y,r[13]=M*i+P*u+T*p+D*x,r[14]=M*o+P*c+T*f+D*g,r[15]=M*a+P*h+T*d+D*A,r}function i(t,e,r){return r[0]=t[0]*e[0],r[1]=t[1]*e[0],r[2]=t[2]*e[0],r[3]=t[3]*e[0],r[4]=t[4]*e[1],r[5]=t[5]*e[1],r[6]=t[6]*e[1],r[7]=t[7]*e[1],r[8]=t[8]*e[2],r[9]=t[9]*e[2],r[10]=t[10]*e[2],r[11]=t[11]*e[2],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r}function o(t,e,r){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12],r[13]=t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13],r[14]=t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14],r[15]=t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15],r}function a(t,e,r,n){var i=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);if(!i)return null;var o=r[0],a=r[1],s=r[2];1!=i&&(i=1/i,o*=i,a*=i,s*=i);var u=Math.sin(e),c=Math.cos(e),h=1-c,l=t[0],p=t[1],f=t[2],d=t[3],y=t[4],x=t[5],g=t[6],A=t[7],v=t[8],m=t[9],L=t[10],_=t[11],O=o*o*h+c,G=a*o*h+s*u,w=s*o*h-a*u,S=o*a*h-s*u,R=a*a*h+c,b=s*a*h+o*u,E=o*s*h+a*u,C=a*s*h-o*u,M=s*s*h+c;return e?t!=n&&(n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]):n=t,n[0]=l*O+y*G+v*w,n[1]=p*O+x*G+m*w,n[2]=f*O+g*G+L*w,n[3]=d*O+A*G+_*w,n[4]=l*S+y*R+v*b,n[5]=p*S+x*R+m*b,n[6]=f*S+g*R+L*b,n[7]=d*S+A*R+_*b,n[8]=l*E+y*C+v*M,n[9]=p*E+x*C+m*M,n[10]=f*E+g*C+L*M,n[11]=d*E+A*C+_*M,n}function s(t,e,n,i){var o=t[0],a=t[1],s=t[2],u=n[0],c=n[1],h=n[2],l=e[0],p=e[1],f=e[2];if(o==l&&a==p&&s==f)return r(i);var d,y,x,g,A,v,m,L,_,O;return m=o-e[0],L=a-e[1],_=s-e[2],O=1/Math.sqrt(m*m+L*L+_*_),m*=O,L*=O,_*=O,d=c*_-h*L,y=h*m-u*_,x=u*L-c*m,O=Math.sqrt(d*d+y*y+x*x),O?(O=1/O,d*=O,y*=O,x*=O):(d=0,y=0,x=0),g=L*x-_*y,A=_*d-m*x,v=m*y-L*d,O=Math.sqrt(g*g+A*A+v*v),O?(O=1/O,g*=O,A*=O,v*=O):(g=0,A=0,v=0),i[0]=d,i[1]=g,i[2]=m,i[3]=0,i[4]=y,i[5]=A,i[6]=L,i[7]=0,i[8]=x,i[9]=v,i[10]=_,i[11]=0,i[12]=-(d*o+y*a+x*s),i[13]=-(g*o+A*a+v*s),i[14]=-(m*o+L*a+_*s),i[15]=1,i}function u(t,e,r,n,i){var o=r*Math.tan(t*Math.PI/360),a=o*e,s=2*a,u=2*o,c=n-r;return i[0]=2*r/s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*r/u,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=-(n+r)/c,i[11]=-1,i[12]=0,i[13]=0,i[14]=-(n*r*2)/c,i[15]=0,i}function c(t,e){return e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e}function h(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],h=t[8],l=t[9],p=t[10],f=t[11],d=t[12],y=t[13],x=t[14],g=t[15],A=r*s-n*a,v=r*u-i*a,m=r*c-o*a,L=n*u-i*s,_=n*c-o*s,O=i*c-o*u,G=h*y-l*d,w=h*x-p*d,S=h*g-f*d,R=l*x-p*y,b=l*g-f*y,E=p*g-f*x,C=1/(A*E-v*b+m*R+L*S-_*w+O*G);return e[0]=(s*E-u*b+c*R)*C,e[1]=(-n*E+i*b-o*R)*C,e[2]=(y*O-x*_+g*L)*C,e[3]=(-l*O+p*_-f*L)*C,e[4]=(-a*E+u*S-c*w)*C,e[5]=(r*E-i*S+o*w)*C,e[6]=(-d*O+x*m-g*v)*C,e[7]=(h*O-p*m+f*v)*C,e[8]=(a*b-s*S+c*G)*C,e[9]=(-r*b+n*S-o*G)*C,e[10]=(d*_-y*m+g*A)*C,e[11]=(-h*_+l*m-f*A)*C,e[12]=(-a*R+s*w-u*G)*C,e[13]=(r*R-n*w+i*G)*C,e[14]=(-d*L+y*v-x*A)*C,e[15]=(h*L-l*v+p*A)*C,e}return t.Matrix4=function(){},t.Matrix4.prototype={constructor:t.Matrix4,create:e,identity:r,multiply:n,scale:i,translate:o,rotate:a,lookAt:s,perspective:u,transpose:c,inverse:h},t.Matrix4}(ALGO),ALGO.Loader=function(){"use strict";function t(){s.open("get",u,!0),s.send(null)}function e(t){s.open("post",u,!0),s.send(t)}function r(t){if(0!==s.status){{o(s.readyState)}if(s.readyState==s.UNSENT);else if(s.readyState==s.OPENED);else if(s.readyState==s.HEADERS_RECEIVED);else if(s.readyState==s.LOADING);else if(s.readyState==s.DONE){var e={};e.status=s.status,e.responseText=s.responseText,n(e)}}}function n(t){a.complete(t)}function i(t){}function o(t){var e;return t==s.UNSENT?e="UNSENT":t==s.OPENED?e="OPENED":t==s.HEADERS_RECEIVED?e="HEADERS_RECEIVED":t==s.LOADING?e="LOADING":t==s.DONE&&(e="DONE"),e}var a,s,u="";return ALGO.Loader=function(t){u=t,s=new XMLHttpRequest,s.onreadystatechange=function(t){r(t)},a=this},ALGO.Loader.prototype={constructor:ALGO.Loader,get:t,post:e,complete:i},ALGO.Loader}(),ALGO.ShapeCtrl={createID:function(t,e){for(var r="abcdefghijklmnopqrstuvwxyz0123456789",n=e?e:12,i="",o=0;n>o;o++){var a=r.length,s=Math.floor(Math.random()*a);i+=r.charAt(s)}return t.indexOf(i)>-1&&arguments.callee(t,e),i}},ALGO.Shape=function(){"use strict";function t(){this.geometry=[],this.vertexPosition=[],this.vertexColors=[],this.vertexLineColors=[],this.index=[],this.m=new ALGO.Matrix3,this.matrix=this.m.identity(this.m.create()),this.matrixScale=this.m.identity(this.m.create()),this.matrixRotate=this.m.identity(this.m.create()),this.matrixTranslate=this.m.identity(this.m.create())}function e(){this.setGeometry(),this.setVertexPosition(),this.setVertexColor(this.color,this.vertexColors),this.setVertexAlpha(this.alpha,this.vertexColors),this.setVertexColor(this.lineColor,this.vertexLineColors),this.setVertexAlpha(this.lineAlpha,this.vertexLineColors),this.setIndex(),this.setScale(this.scale),this.setRotate(this.rotate),this.setTranslate(this.x,this.y)}function r(t){this.id||(this.id=ALGO.ShapeCtrl.createID(t.displayObjects,8)),t.displayObjects.push(this.id),t.children.push(this)}function n(t){var e=t.displayObjects.indexOf(id);e>-1&&(t.displayObjects.splice(e,1),t.children.splice(e,1))}function i(){this.geometry=[],this.vertexPosition=[],this.vertexColors=[],this.vertexLineColors=[],this.setVertexPosition(),this.setVertexColor(this.color,this.vertexColors),this.setVertexAlpha(this.alpha,this.vertexColors),this.setVertexColor(this.lineColor,this.vertexLineColors),this.setVertexAlpha(this.lineAlpha,this.vertexLineColors)}function o(){}function a(){var t=this.geometry;t[0]={x:0,y:-1},t[1]={x:-.87,y:.5},t[2]={x:.87,y:.5}}function s(){for(var t=this.vertexPosition,e=this.geometry.length,r=0;e>r;r++){var n=2*r;t[n]=this.geometry[r].x,t[n+1]=this.geometry[r].y}}function u(t,e){for(var r=e,n=this.geometry.length,i=ALGO.ColorUtil.hexToRgbNormalize(t),o=0;n>o;o++){var a=4*o;r[a]=i.r,r[a+1]=i.g,r[a+2]=i.b}}function c(t,e){for(var r=e,n=this.geometry.length,i=0;n>i;i++){var o=4*i;r[o+3]=t}}function h(){var t=[0,1,2];this.index=t}function l(t){if(this.m){var e=this.radius*t,r=this.radius*t;this.m.scale(this.matrix,[e,r,0],this.matrixScale)}}function p(t){if(this.m){var e=t*Math.PI/180;this.m.rotate(this.matrix,e,this.matrixRotate)}}function f(t,e){this.m&&this.m.translate(this.matrix,[t,e,0],this.matrixTranslate)}function d(){var t=null;return this.m&&(t=this.m.identity(this.m.create()),this.m.multiply(t,this.matrixScale,t),this.m.multiply(t,this.matrixRotate,t),this.m.multiply(t,this.matrixTranslate,t)),t}return ALGO.Shape=function(t,e,r){this.x=t,this.y=e,this.angles=3,this.radius=r,this.angles_=3,this.radius_=r,this.init(),this.setup()},ALGO.Shape.prototype={constructor:ALGO.Shape,name:"",type:"shape",id:null,x:0,y:0,angles:void 0,radius:null,alpha:1,visible:!0,color:16777215,scale:1,rotate:0,line:!1,lineColor:0,lineAlpha:1,lineWidth:1,fill:!0,m:void 0,matrix:void 0,matrixScale:void 0,matrixRotate:void 0,matrixTranslate:void 0,parent:void 0,children:[],geometry:[],vertexPosition:[],vertexColors:[],vertexLineColors:[],needsUpdate:!1,geometry:[],index:[],x_:0,y_:0,scale_:1,rotate_:0,radius_:null,color_:16777215,alpha_:1,angle_:void 0,needsUpdate_:!1,lineColor_:0,lineAlpha_:1,init:t,setup:e,add:r,remove:n,clone:o,clear:i,setGeometry:a,setVertexPosition:s,setVertexColor:u,setVertexAlpha:c,setIndex:h,setScale:l,setRotate:p,setTranslate:f,getMatrix:d},ALGO.Shape}(),ALGO.Shape.prototype.__defineGetter__("x",function(){return this.x_}),ALGO.Shape.prototype.__defineSetter__("x",function(t){this.x_=t,this.setTranslate(this.x,this.y)}),ALGO.Shape.prototype.__defineGetter__("y",function(){return this.y_}),ALGO.Shape.prototype.__defineSetter__("y",function(t){this.y_=t,this.setTranslate(this.x,this.y)}),ALGO.Shape.prototype.__defineGetter__("scale",function(){return this.scale_}),ALGO.Shape.prototype.__defineSetter__("scale",function(t){this.setScale(t),this.scale_=t}),ALGO.Shape.prototype.__defineGetter__("rotate",function(){return this.rotate_}),ALGO.Shape.prototype.__defineSetter__("rotate",function(t){this.setRotate(t),this.rotate_=t}),ALGO.Shape.prototype.__defineGetter__("radius",function(){return this.radius_}),ALGO.Shape.prototype.__defineSetter__("radius",function(t){this.setScale(this.scale),this.radius_=t}),ALGO.Shape.prototype.__defineGetter__("color",function(){return this.color_}),ALGO.Shape.prototype.__defineSetter__("color",function(t){this.setVertexColor(t,this.vertexColors),this.color_=t}),ALGO.Shape.prototype.__defineGetter__("alpha",function(){return this.alpha_}),ALGO.Shape.prototype.__defineSetter__("alpha",function(t){this.setVertexAlpha(t,this.vertexColors),this.alpha_=t}),ALGO.Shape.prototype.__defineGetter__("lineColor",function(){return this.lineColor_}),ALGO.Shape.prototype.__defineSetter__("lineColor",function(t){this.setVertexColor(t,this.vertexLineColors),this.lineColor_=t}),ALGO.Shape.prototype.__defineGetter__("lineAlpha",function(){return this.lineAlpha_}),ALGO.Shape.prototype.__defineSetter__("lineAlpha",function(t){this.setVertexAlpha(t,this.vertexLineColors),this.lineAlpha_=t}),ALGO.Shape.prototype.__defineGetter__("angle",function(){return this.angle_}),ALGO.Shape.prototype.__defineSetter__("angle",function(t){this.angle_=t}),ALGO.Shape.prototype.__defineGetter__("needsUpdate",function(){return this.needsUpdate_}),ALGO.Shape.prototype.__defineSetter__("needsUpdate",function(t){this.needsUpdate_=t}),ALGO.Polygon=function(t,e,r,n){"use strict";this.x=t,this.y=e,this.angles=r,this.radius=n,this.angles_=r,this.radius_=n,this.type="polygon",this.init(),this.setup()},ALGO.Polygon.prototype=Object.create(ALGO.Shape.prototype),ALGO.Polygon.prototype.constructor=ALGO.Polygon,ALGO.Polygon.prototype.setGeometry=function(){for(var t=this.geometry=[],e=0;e<this.angles;e++)t[e]={},t[e].x=Math.cos(2*e*Math.PI/this.angles-Math.PI/2),t[e].y=Math.sin(2*e*Math.PI/this.angles-Math.PI/2)},ALGO.Polygon.prototype.setIndex=function(){var t=this.index=[];for(i=1;i<this.angles-1;i++)t.push(0),t.push(i),t.push(i+1)},ALGO.Circle=function(t,e,r){"use strict";this.x=t,this.y=e,this.angles=ALGO.circleResolution,this.radius=r,this.angles_=ALGO.circleResolution,this.radius_=r,this.type="circle",this.init(),this.setup()},ALGO.Circle.prototype=Object.create(ALGO.Polygon.prototype),ALGO.Circle.prototype.constructor=ALGO.Circle,ALGO.Rectangle=function(t,e,r,n){"use strict";this.x=t,this.y=e,this.width=r,this.height=n,this.width_=r,this.height_=n,this.type="rectangle",this.init(),this.setup()},ALGO.Rectangle.prototype=Object.create(ALGO.Shape.prototype),ALGO.Rectangle.prototype.constructor=ALGO.Rectangle,ALGO.Rectangle.prototype.width=0,ALGO.Rectangle.prototype.height=0,ALGO.Rectangle.prototype.width_=0,ALGO.Rectangle.prototype.height_=0,ALGO.Rectangle.prototype.setGeometry=function(){var t=this.geometry=[];t[0]=[],t[0].x=-.5,t[0].y=-.5,t[1]=[],t[1].x=.5,t[1].y=-.5,t[2]=[],t[2].x=.5,t[2].y=.5,t[3]=[],t[3].x=-.5,t[3].y=.5},ALGO.Rectangle.prototype.setScale=function(t){if(this.m){var e=this.width*t,r=this.height*t;this.m.scale(this.matrix,[e,r,0],this.matrixScale)}},ALGO.Rectangle.prototype.setIndex=function(){var t=[0,1,2,0,2,3];this.index=t},ALGO.Rectangle.prototype.__defineGetter__("width",function(){return this.width_}),ALGO.Rectangle.prototype.__defineSetter__("width",function(t){this.width_=t,this.setScale(this.scale)}),ALGO.Rectangle.prototype.__defineGetter__("height",function(){return this.height_}),ALGO.Rectangle.prototype.__defineSetter__("height",function(t){this.height_=t,this.setScale(this.scale)}),ALGO.Path=function(t,e){"use strict";this.start=t,this.end=e,this.type="path",this.init(),this.setup(),this.initLine()},ALGO.Path.prototype=Object.create(ALGO.Shape.prototype),ALGO.Path.prototype.constructor=ALGO.Path,ALGO.Path.prototype.closed=!1,ALGO.Path.prototype.setGeometry=function(){},ALGO.Path.prototype.setScale=function(t){if(this.m){var e=t,r=t;this.m.scale(this.matrix,[e,r,0],this.matrixScale)}},ALGO.Path.prototype.initLine=function(){var t=this.start,e=this.end;t&&this.moveTo(t.x,t.y),e&&this.lineTo(e.x,e.y)},ALGO.Path.prototype.moveTo=function(t,e){var r={x:t,y:e};this.geometry.push(r),this.vertexUpdate()},ALGO.Path.prototype.lineTo=function(t,e){var r={x:t,y:e};this.geometry.push(r),this.vertexUpdate()},ALGO.Path.prototype.vertexUpdate=function(){this.setVertexPosition(),this.setVertexColor(this.color,this.vertexColors),this.setVertexAlpha(this.alpha,this.vertexColors),this.setVertexColor(this.lineColor,this.vertexLineColors),this.setVertexAlpha(this.lineAlpha,this.vertexLineColors)},ALGO.Path.prototype.close=function(){this.closed=!0},ALGO.SVG=function(){"use strict";function t(){}function e(t){var e=new ALGO.Loader(t);e.get(),e.complete=function(t){var e=t.status,n=t.responseText;if(e>=200&&300>e){var i=o(n),a=r(i);if(a&&p.always){var s={verticles:a};p.always(s)}}}}function r(t){for(var e=t.childNodes,r=0;r<e.length;r++){var i=e[r];if(1==i.nodeType){var o=n(i);if(o&&(f.push(o),p.complete)){var a={vertex:o};p.complete(a)}}}return f}function n(t){var e,n=t.nodeName.toLowerCase();return"svg"===n?r(t):"g"===n?r(t):"path"===n&&(e=i(t)),e}function i(t){function e(t,e){var r=+n[t];return c&&(r+=h[e]),r}function r(t){var r=e(t,"x"),n=e(t+1,"y"),i={x:r,y:n};return i}for(var n,i,o,s=t.getAttribute("d"),u=s.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/gi),c=!1,h={x:0,y:0},l=[],p=[],f=0,d=u&&u.length;d>f;f++){var y=u[f],x=y[0],g=x.toLowerCase(),n=y.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),A=n&&n.length;switch(c=x===g,"z"===i&&(/[mz]/.test(g)||ALGO.log("TEST TRUE")),22==d&&f>15&&(ALGO.log(f+"/"+d+", "+x+"("+g+"), "+A),ALGO.log(n)),g){case"m":case"l":for(var v=0;A>v;v+=2)h=r(v),p.push({x:h.x,y:h.y});break;case"h":case"v":for(var m="h"===g?"x":"y",v=0;A>v;v++)h[m]=e(v,m),p.push({x:h.x,y:h.y});break;case"c":for(var v=0;A>v;v+=6){var L=r(v),_=o=r(v+2),O=h;h=r(v+4);for(var G=a(O.x,O.y,L.x,L.y,_.x,_.y,h.x,h.y),w=0;w<G.length;w++)p.push(G[w]);ALGO.log("current: "+O.x+", "+O.y+"   control: "+L.x+", "+L.y),ALGO.log("current: "+h.x+", "+h.y+"   control: "+_.x+", "+_.y),ALGO.log(G),p.push({x:h.x,y:h.y})}break;case"s":for(var v=0;A>v;v+=4){var _=h;if(/[cs]/.test(i)){var S=2*h.x-o.x,R=2*h.y-o.y;_={x:S,y:R}}var L=o=r(v),O=h;h=r(v+2);for(var G=a(O.x,O.y,_.x,_.y,L.x,L.y,h.x,h.y),w=0;w<G.length;w++)p.push(G[w]);i=g,p.push({x:h.x,y:h.y})}break;case"q":for(var v=0;A>v;v+=4)o=r(v),h=r(v+2),p.push({x:h.x,y:h.y});break;case"t":for(var v=0;A>v;v+=2)o=/[qt]/.test(i)?h.multiply(2).subtract(o):h,h=r(v),i=g;break;case"a":for(var v=0;A>v;v+=7)h=r(v+5),p.push({x:h.x,y:h.y});break;case"z":l.push(p),p=[]}22==d&&f>15&&ALGO.log(h),ALGO.log(""),i=g}return l}function o(t){if("undefined"!=typeof Windows&&"undefined"!=typeof Windows.Data&&"undefined"!=typeof Windows.Data.Xml){var e=new Windows.Data.Xml.Dom.XmlDocument,r=new Windows.Data.Xml.Dom.XmlLoadSettings;return r.prohibitDtd=!1,e.loadXml(t,r),e}if(window.DOMParser){var n=new DOMParser;return n.parseFromString(t,"text/xml")}t=t.replace(/<!DOCTYPE svg[^>]*>/,"");var e=new ActiveXObject("Microsoft.XMLDOM");return e.async="false",e.loadXML(t),e}function a(t,e,r,n,i,o,a,u){for(var c=[],h=0;1.01>=h;h+=.1)c.push(s({x:t,y:e},{x:r,y:n},{x:i,y:o},{x:a,y:u},h));return c}function s(t,e,r,n,i){var o={x:0,y:0},a=(1-i)*(1-i)*(1-i);return o.x+=a*t.x,o.y+=a*t.y,a=3*i*(1-i)*(1-i),o.x+=a*e.x,o.y+=a*e.y,a=3*i*i*(1-i),o.x+=a*r.x,o.y+=a*r.y,a=i*i*i,o.x+=a*n.x,o.y+=a*n.y,o}function u(){}function c(){}function h(t,e){this[t]=e}function l(t,e){p[t]=null}var p,f=[];return ALGO.SVG=function(){t(),p=this},ALGO.SVG.prototype={constructor:ALGO.SVG,load:e,bind:h,unbind:l,complete:u,always:c},ALGO.SVG}(),ALGO.WebGLRenderer=function(t){"use strict";function e(t,e){return[2/t,0,0,0,-2/e,0,-1,1,1]}function r(){for(var r=new t.Matrix3,n=e(m,L),i=0;i<b.length;i++){var o=b[i],a=o.needsUpdate,s=o.fill,u=o.line,c=o.vertexPosition,h=o.vertexColors,l=o.vertexLineColors||o.vertexColors,y=o.index,g=o.getMatrix(),O=r.multiply(g,n,[]),G=o.lineWidth;if(s){if(!C[i]||a){var w=[];w.position=p(c),w.color=p(h),C[i]=w}if(d(C[i],A,v),"path"!==o.type&&"particle"!==o.type){if(!P[i]||a){var S=f(y);T[i]=y,P[i]=S}x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,P[i])}x.uniformMatrix3fv(_.matrix,!1,O),"path"==o.type?o.closed?x.drawArrays(x.TRIANGLES,0,c.length/2):x.drawArrays(x.TRIANGLES,0,c.length/2):"particle"==o.type?x.drawArrays(x.POINTS,0,c.length/2):x.drawElements(x.TRIANGLES,T[i].length,x.UNSIGNED_SHORT,0)}if(u){if(!M[i]||a){var w=[];w.position=p(c),w.color=p(l),M[i]=w}d(M[i],A,v),x.uniformMatrix3fv(_.matrix,!1,O),x.lineWidth(G),"path"==o.type?o.closed?x.drawArrays(x.LINE_LOOP,0,c.length/2):x.drawArrays(x.LINE_STRIP,0,c.length/2):x.drawArrays(x.LINE_LOOP,0,c.length/2)}a&&(o.needsUpdate=!1)}x.flush()}function n(){m=O.width,L=O.height;var t=x.getUniformLocation(g,"u_resolution");x.uniform2f(t,O.width,O.height),x.viewport(0,0,m,L)}function i(){o(y),a(),S&&(s(),u()),c()}function o(t){O=t.canvas,G=t.background,w=t.backgroundAlpha,S=t.backgroundAuto,R=t.depth,b=t.children,E=t.displayObjects}function a(){x.clearDepth(R)}function s(){var e=t.ColorUtil.hexToRgbNormalize(G);x.clearColor(e.r,e.g,e.b,w)}function u(){x.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT)}function c(){r()}function h(t){var e,r="";return"vertex"==t?(r="\r\n      attribute vec2 position2d;\r\n      uniform mat3 matrix2d;\r\n      uniform vec2 u_resolution;\r\n      attribute vec4 color;\r\n      varying   vec4 v_color; \r\n      uniform float point_size;\r\n      \r\n      void main(void){\r\n        v_color = color;\r\n        gl_PointSize = point_size;\r\n        \r\n        gl_Position = vec4((matrix2d * vec3(position2d, 1)).xy, 0, 1);\r\n      }",e=x.createShader(x.VERTEX_SHADER)):"fragment"==t&&(r="\r\n      precision mediump float;\r\n      varying vec4 v_color;\r\n      \r\n      void main(void){\r\n        gl_FragColor = v_color;\r\n      }",e=x.createShader(x.FRAGMENT_SHADER)),x.shaderSource(e,r),x.compileShader(e),x.getShaderParameter(e,x.COMPILE_STATUS)?e:void alert(x.getShaderInfoLog(e))}function l(t,e){var r=x.createProgram();return x.attachShader(r,t),x.attachShader(r,e),x.linkProgram(r),x.getProgramParameter(r,x.LINK_STATUS)?(x.useProgram(r),r):void alert(x.getProgramInfoLog(r))}function p(t){var e=x.createBuffer();return x.bindBuffer(x.ARRAY_BUFFER,e),x.bufferData(x.ARRAY_BUFFER,new Float32Array(t),x.STATIC_DRAW),x.bindBuffer(x.ARRAY_BUFFER,null),e}function f(t){var e=x.createBuffer();return x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,e),x.bufferData(x.ELEMENT_ARRAY_BUFFER,new Int16Array(t),x.STATIC_DRAW),x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,null),e}function d(t,e,r){for(var n in t)x.bindBuffer(x.ARRAY_BUFFER,t[n]),x.enableVertexAttribArray(e[n]),x.vertexAttribPointer(e[n],r[n],x.FLOAT,!1,0,0)}var y,x,g,A,v,m,L,_,O,G,w,S,R,b,E,C=[],M=[],P=[],T=[];return t.WebGLRenderer=function(t){y=t,o(y),x=O.getContext("webgl")||O.getContext("experimental-webgl");var e=h("vertex"),i=h("fragment");g=l(e,i),n(),_={},_.position=x.getUniformLocation(g,"position2d"),_.matrix=x.getUniformLocation(g,"matrix2d"),_.color=x.getUniformLocation(g,"color"),_.point_size=x.getUniformLocation(g,"point_size"),A={},A.position=x.getAttribLocation(g,"position2d"),A.color=x.getAttribLocation(g,"color"),v={},v.position=2,v.color=4,r()},t.WebGLRenderer.prototype={constructor:t.WebGLRenderer,update:i,resize:n},t.WebGLRenderer}(ALGO),ALGO.log=function(t){window.console&&window.console.log&&ALGO.debug&&window.console.log(t)},ALGO.warn=function(t){window.console&&window.console.warn&&ALGO.debug&&window.console.warn(t)},ALGO.error=function(t){window.console&&window.console.error&&ALGO.debug&&window.console.error(t)},ALGO.PointUtil={normalize:function(t,e){var r=Math.sqrt(t.x*t.x+t.y*t.y);0!=r&&(t.x=e*t.x/r,t.y=e*t.y/r)},normalize3:function(t,e){var r=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z);return 0!=r&&(t.x=e*t.x/r,t.y=e*t.y/r,t.z=e*t.z/r),t},pointLength3:function(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)},getDistance:function(t,e){var r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)},getSlope:function(t,e){return(e.y-t.y)/(e.x-t.x)},getIntercept:function(t,e,r){var n=t.x+e.x,i=t.y+e.y;return i/2-r*n/2},getMidpoint:function(t,e){var r=[];return r.x=(t.x+e.x)/2,r.y=(t.y+e.y)/2,r},getMidperpendicular:function(t,e){var r=getSlope(t,e);x=checkEQ(r)?1:-1/r;var n=getMidpoint(t,e);return y=checkEQ(r)?0:n.y-x*n.x,{x:x,y:y}},getThroughPoint3:function(t,e,r){var n=getMidperpendicular(t,e),i=getMidperpendicular(t,r),o=[];o.x=(i.y-n.y)/(n.x-i.x),o.y=n.x*o.x+n.y;var a=Math.sqrt(Math.pow(o.x-t.x,2)+Math.pow(o.y-t.y,2));return{x:o.x,y:o.y,rad:a}},getHugeTriangle:function(t,e,r){var n=getThroughPoint3(t,e,r),i=n.x-Math.sqrt(3)*n.rad,o=n.y-n.rad,a=n.x+Math.sqrt(3)*n.rad,s=n.y-n.rad,u=n.x,c=n.y+2*n.rad;return[{x:i,y:o},{x:a,y:s},{x:u,y:c}]},checkEQ:function(t){var e=1e-6;return t>=-e&&e>=t}},ALGO.StringUtil={zeroPadding:function(t,e){return(Array(e).join("0")+t).slice(-e)},numComma:function(t){return String(t).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},separate:function(t){return String(t).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")}},ALGO.ObjectUtil={extend:function(t,e){ALGO.ObjectUtil.clone(t);for(key in e){var r=e[key]?e[key]:t[key];t[key]=r}return t},clone:function(t){var e={};for(key in t)e[key]=t[key];return e}},ALGO.ColorUtil={rgbToHex:function(t,e,r){t=Math.floor(t),e=Math.floor(e),r=Math.floor(r);var n=(t<<16)+(e<<8)+r;return"0x"+n.toString(16)},hexToRgb:function(t){t=t.toString(16).replace("#","").replace("0x",""),t="0x"+t;var e={r:t>>16,g:t>>8&255,b:255&t};return e},hexToRgbNormalize:function(t){var e=ALGO.ColorUtil.hexToRgb(t);return e.r=e.r/256,e.g=e.g/256,e.b=e.b/256,e}},ALGO.Util={getBrowserLang:function(){var t=window.navigator.userAgent.toLowerCase();try{return-1!=t.indexOf("chrome")?(navigator.languages[0]||navigator.browserLanguage||navigator.language||navigator.userLanguage).substr(0,2):(navigator.browserLanguage||navigator.language||navigator.userLanguage).substr(0,2)}catch(e){return void 0}},isSmartDevice:function(){var t=navigator.userAgent,e=!1;return t.indexOf("iPhone")>0&&-1==t.indexOf("iPad")||t.indexOf("iPod")>0||t.indexOf("Android")>0&&t.indexOf("Mobile")>0?e="smartphone":(t.indexOf("iPad")>0||t.indexOf("Android")>0)&&(e="tablet"),e},getOS:function(){var t,e=window.navigator.userAgent.toLowerCase();return t=e.match(/win/)?"win":e.match(/mac|ppc/)?"mac":e.match(/linux/)?"linux":"other"},getBrowser:function(){var t=window.navigator.userAgent.toLowerCase(),e=window.navigator.appVersion.toLowerCase(),r="unknown";return-1!=t.indexOf("msie")?r=-1!=e.indexOf("msie 6.")?"ie6":-1!=e.indexOf("msie 7.")?"ie7":-1!=e.indexOf("msie 8.")?"ie8":-1!=e.indexOf("msie 9.")?"ie9":-1!=e.indexOf("msie 10.")?"ie10":"ie":-1!=t.indexOf("trident/7")?r="ie11":-1!=t.indexOf("chrome")?r="chrome":-1!=t.indexOf("safari")?r="safari":-1!=t.indexOf("opera")?r="opera":-1!=t.indexOf("firefox")&&(r="firefox"),r},isSupported:function(t){for(var e=getBrowser(),r=0;r<t.length;r++)if(t[r]==e)return!0;return!1},getQuery:function(){for(var t=window.location.search.substring(1),e=t.split("&"),r={},n=0;n<e.length;n++){var i=e[n].indexOf("=");if(i>0){var o=e[n].substring(0,i),a=e[n].substring(i+1);r[o]=a}}return r}};